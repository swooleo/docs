{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u4ecb\u7ecd Swoole \u662f\u4e00\u4e2a\u9762\u5411\u751f\u4ea7\u73af\u5883\u7684 PHP \u534f\u7a0b\u6846\u67b6\u3002 \u6ce8\u610f \u672c\u6587\u6863\u59cb\u7ec8\u4ee5\u6700\u65b0\u7684 Swoole \u4e3a\u51c6\u3002","title":"\u4ecb\u7ecd"},{"location":"#_1","text":"Swoole \u662f\u4e00\u4e2a\u9762\u5411\u751f\u4ea7\u73af\u5883\u7684 PHP \u534f\u7a0b\u6846\u67b6\u3002","title":"\u4ecb\u7ecd"},{"location":"#_2","text":"\u672c\u6587\u6863\u59cb\u7ec8\u4ee5\u6700\u65b0\u7684 Swoole \u4e3a\u51c6\u3002","title":"\u6ce8\u610f"},{"location":"\u5feb\u901f\u5f00\u59cb/","text":"\u5feb\u901f\u5f00\u59cb Swoole \u53ef\u4ee5\u901a\u8fc7 Pecl \u6216\u8005\u6e90\u7801\u6765\u8fdb\u884c\u5b89\u88c5\u3002 Pecl\uff08\u63a8\u8350\uff09 \u9996\u5148\u901a\u8fc7 pecl \u5de5\u5177\u4e0b\u8f7d\u548c\u7f16\u8bd1 Swoole \u6269\u5c55\uff1a # \u5b89\u88c5\u6700\u65b0\u7248\u672c pecl install swoole # \u5b89\u88c5\u6307\u5b9a\u7248\u672c pecl install swoole-4.4.8 \u7f16\u8bd1\u6210\u529f\u4e4b\u540e\uff0c\u628a Swoole \u6dfb\u52a0\u5230 php.ini \u914d\u7f6e\u6587\u4ef6\u91cc\u9762\u3002\u914d\u7f6e\u6587\u4ef6\u7684\u8def\u5f84\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u67e5\u627e\uff0c\u4f8b\u5982\uff1a php --ini Configuration File ( php.ini ) Path: /etc Loaded Configuration File: /etc/php.ini Scan for additional .ini files in: /etc/php.d \u63a8\u8350\u5728 additional .ini \u76ee\u5f55\u91cc\u9762\u5355\u72ec\u4e3a Swoole \u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u4f8b\u5982\uff1a touch /etc/php.d/swoole.ini cat > /etc/php.d/swoole.ini <<EOF ; Enable swoole extension module extension=swoole.so EOF \u6e90\u7801\u5b89\u88c5 \u4e0b\u8f7d\u4e00\u4efd\u5df2\u7ecf release \u7684 Swoole \u6e90\u7801\uff1a curl -L https://github.com/swoole/swoole-src/archive/v4.4.12.tar.gz -o swoole-src-4.4.12.tar.gz \\ && tar -xvf swoole-src-4.4.12.tar.gz \\ && cd swoole-src-4.4.12 \\ && phpize \\ && ./configure \\ && make -j4 \\ && make install \u7136\u540e\u6309\u7167\u4e0a\u9762\u7684\u65b9\u5f0f\u628a Swoole \u6dfb\u52a0\u5230\u914d\u7f6e\u6587\u4ef6 php.ini \u91cc\u9762\u5373\u53ef\u3002 \u9a8c\u8bc1\u662f\u5426\u5b89\u88c5\u6210\u529f php --ri swoole \u5e38\u89c1\u95ee\u9898 \u5728\u5b89\u88c5\u6269\u5c55\u7684\u65f6\u5019\uff0c\u6700\u5e38\u89c1\u7684\u4e00\u4e2a\u95ee\u9898\u6709\u4e24\u4e2a\u3002 'openssl/ssl.h' file not found \u8fd9\u4e2a\u662f\u56e0\u4e3a\u7f16\u8bd1\u5668\u6ca1\u6709\u627e\u5230 openssl/ssl.h \u8fd9\u4e2a\u5934\u6587\u4ef6\u3002\u53ef\u80fd\u662f\u56e0\u4e3a\u6ca1\u6709\u4e0b\u8f7d openssl-dev \u5e93\uff0c\u53ea\u9700\u8981\u4e0b\u8f7d\u5bf9\u5e94\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684 openssl-dev \u5373\u53ef\u3002\u5982\u679c\u4e0b\u8f7d\u4e86 openssl-dev \u5e93\u4e4b\u540e\u4f9d\u7136\u62a5\u8fd9\u4e2a\u9519\u8bef\uff0c\u90a3\u4e48\u8bf4\u660e\u5728\u7f16\u8bd1 Swoole \u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u5934\u6587\u4ef6\u4e0d\u5728\u7f16\u8bd1\u5668\u7684\u641c\u7d22\u8def\u5f84\u91cc\u9762\u3002\u4f8b\u5982\uff0c\u5728 mac \u4e0a\uff0c\u4e0b\u8f7d\u7684 openssl-dev \u5e93\u9ed8\u8ba4\u662f\u5728 /usr/local/opt/openssl/ \u91cc\u9762\u3002\u6b64\u65f6\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a /usr/local/opt/openssl/include/openssl/ \u7684\u8f6f\u8fde\u63a5\u5230\u7f16\u8bd1\u5668\u9ed8\u8ba4\u7684\u641c\u7d22\u8def\u5f84 /usr/local/include/ \u91cc\u9762\u5373\u53ef\u3002 Enable openssl support, require openssl library \u8fd9\u4e2a\u662f\u56e0\u4e3a\u5728\u94fe\u63a5 openssl library \u5e93\u7684\u65f6\u5019\uff0c\u7f16\u8bd1\u5668\u6ca1\u6709\u627e\u5230\u3002\u8fd9\u4e2a\u95ee\u9898\u548c 'openssl/ssl.h' file not found \u7c7b\u4f3c\uff0c\u8981\u4e48\u662f\u6ca1\u6709\u4e0b\u8f7d openssl library \u5e93\uff0c\u8981\u4e48\u662f\u8fd9\u4e2a\u5e93\u4e0d\u5728\u7f16\u8bd1\u5668\u7684\u641c\u7d22\u8def\u5f84\u91cc\u9762\u3002\u4f8b\u5982\uff0c\u5728 mac \u4e0a\uff0c\u4e0b\u8f7d\u7684 openssl library \u9ed8\u8ba4\u662f\u5728 /usr/local/opt/openssl/ \u91cc\u9762\u3002\u6b64\u65f6\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a /usr/local/opt/openssl/lib/ \u7684\u8f6f\u8fde\u63a5\u5230\u7f16\u8bd1\u5668\u9ed8\u8ba4\u7684\u641c\u7d22\u8def\u5f84 /usr/local/lib/ \u91cc\u9762\u5373\u53ef\u3002","title":"\u5feb\u901f\u5f00\u59cb"},{"location":"\u5feb\u901f\u5f00\u59cb/#_1","text":"Swoole \u53ef\u4ee5\u901a\u8fc7 Pecl \u6216\u8005\u6e90\u7801\u6765\u8fdb\u884c\u5b89\u88c5\u3002","title":"\u5feb\u901f\u5f00\u59cb"},{"location":"\u5feb\u901f\u5f00\u59cb/#pecl","text":"\u9996\u5148\u901a\u8fc7 pecl \u5de5\u5177\u4e0b\u8f7d\u548c\u7f16\u8bd1 Swoole \u6269\u5c55\uff1a # \u5b89\u88c5\u6700\u65b0\u7248\u672c pecl install swoole # \u5b89\u88c5\u6307\u5b9a\u7248\u672c pecl install swoole-4.4.8 \u7f16\u8bd1\u6210\u529f\u4e4b\u540e\uff0c\u628a Swoole \u6dfb\u52a0\u5230 php.ini \u914d\u7f6e\u6587\u4ef6\u91cc\u9762\u3002\u914d\u7f6e\u6587\u4ef6\u7684\u8def\u5f84\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u67e5\u627e\uff0c\u4f8b\u5982\uff1a php --ini Configuration File ( php.ini ) Path: /etc Loaded Configuration File: /etc/php.ini Scan for additional .ini files in: /etc/php.d \u63a8\u8350\u5728 additional .ini \u76ee\u5f55\u91cc\u9762\u5355\u72ec\u4e3a Swoole \u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u4f8b\u5982\uff1a touch /etc/php.d/swoole.ini cat > /etc/php.d/swoole.ini <<EOF ; Enable swoole extension module extension=swoole.so EOF","title":"Pecl\uff08\u63a8\u8350\uff09"},{"location":"\u5feb\u901f\u5f00\u59cb/#_2","text":"\u4e0b\u8f7d\u4e00\u4efd\u5df2\u7ecf release \u7684 Swoole \u6e90\u7801\uff1a curl -L https://github.com/swoole/swoole-src/archive/v4.4.12.tar.gz -o swoole-src-4.4.12.tar.gz \\ && tar -xvf swoole-src-4.4.12.tar.gz \\ && cd swoole-src-4.4.12 \\ && phpize \\ && ./configure \\ && make -j4 \\ && make install \u7136\u540e\u6309\u7167\u4e0a\u9762\u7684\u65b9\u5f0f\u628a Swoole \u6dfb\u52a0\u5230\u914d\u7f6e\u6587\u4ef6 php.ini \u91cc\u9762\u5373\u53ef\u3002","title":"\u6e90\u7801\u5b89\u88c5"},{"location":"\u5feb\u901f\u5f00\u59cb/#_3","text":"php --ri swoole","title":"\u9a8c\u8bc1\u662f\u5426\u5b89\u88c5\u6210\u529f"},{"location":"\u5feb\u901f\u5f00\u59cb/#_4","text":"\u5728\u5b89\u88c5\u6269\u5c55\u7684\u65f6\u5019\uff0c\u6700\u5e38\u89c1\u7684\u4e00\u4e2a\u95ee\u9898\u6709\u4e24\u4e2a\u3002","title":"\u5e38\u89c1\u95ee\u9898"},{"location":"\u5feb\u901f\u5f00\u59cb/#opensslsslh-file-not-found","text":"\u8fd9\u4e2a\u662f\u56e0\u4e3a\u7f16\u8bd1\u5668\u6ca1\u6709\u627e\u5230 openssl/ssl.h \u8fd9\u4e2a\u5934\u6587\u4ef6\u3002\u53ef\u80fd\u662f\u56e0\u4e3a\u6ca1\u6709\u4e0b\u8f7d openssl-dev \u5e93\uff0c\u53ea\u9700\u8981\u4e0b\u8f7d\u5bf9\u5e94\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684 openssl-dev \u5373\u53ef\u3002\u5982\u679c\u4e0b\u8f7d\u4e86 openssl-dev \u5e93\u4e4b\u540e\u4f9d\u7136\u62a5\u8fd9\u4e2a\u9519\u8bef\uff0c\u90a3\u4e48\u8bf4\u660e\u5728\u7f16\u8bd1 Swoole \u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u5934\u6587\u4ef6\u4e0d\u5728\u7f16\u8bd1\u5668\u7684\u641c\u7d22\u8def\u5f84\u91cc\u9762\u3002\u4f8b\u5982\uff0c\u5728 mac \u4e0a\uff0c\u4e0b\u8f7d\u7684 openssl-dev \u5e93\u9ed8\u8ba4\u662f\u5728 /usr/local/opt/openssl/ \u91cc\u9762\u3002\u6b64\u65f6\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a /usr/local/opt/openssl/include/openssl/ \u7684\u8f6f\u8fde\u63a5\u5230\u7f16\u8bd1\u5668\u9ed8\u8ba4\u7684\u641c\u7d22\u8def\u5f84 /usr/local/include/ \u91cc\u9762\u5373\u53ef\u3002","title":"'openssl/ssl.h' file not found"},{"location":"\u5feb\u901f\u5f00\u59cb/#enable-openssl-support-require-openssl-library","text":"\u8fd9\u4e2a\u662f\u56e0\u4e3a\u5728\u94fe\u63a5 openssl library \u5e93\u7684\u65f6\u5019\uff0c\u7f16\u8bd1\u5668\u6ca1\u6709\u627e\u5230\u3002\u8fd9\u4e2a\u95ee\u9898\u548c 'openssl/ssl.h' file not found \u7c7b\u4f3c\uff0c\u8981\u4e48\u662f\u6ca1\u6709\u4e0b\u8f7d openssl library \u5e93\uff0c\u8981\u4e48\u662f\u8fd9\u4e2a\u5e93\u4e0d\u5728\u7f16\u8bd1\u5668\u7684\u641c\u7d22\u8def\u5f84\u91cc\u9762\u3002\u4f8b\u5982\uff0c\u5728 mac \u4e0a\uff0c\u4e0b\u8f7d\u7684 openssl library \u9ed8\u8ba4\u662f\u5728 /usr/local/opt/openssl/ \u91cc\u9762\u3002\u6b64\u65f6\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a /usr/local/opt/openssl/lib/ \u7684\u8f6f\u8fde\u63a5\u5230\u7f16\u8bd1\u5668\u9ed8\u8ba4\u7684\u641c\u7d22\u8def\u5f84 /usr/local/lib/ \u91cc\u9762\u5373\u53ef\u3002","title":"Enable openssl support, require openssl library"},{"location":"coroutine/channel/__construct/","text":"Channel->__construct Channel \u6784\u9020\u65b9\u6cd5\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine\\Channel::__construct <?php public function __construct ( $capacity = 1 ) { } @ param long | null $capacity @ return void \u6ce8\u610f\uff1a \u6b64Channel\u53ef\u4ee5\u6df7\u5408\u5b58\u50a8\u4efb\u610f\u7c7b\u578b\u7684\u6570\u636e\u3002 \u5e95\u5c42\u4f7f\u7528PHP\u5f15\u7528\u8ba1\u6570\u6765\u4fdd\u5b58\u53d8\u91cf\uff0c\u7f13\u5b58\u533a\u53ea\u9700\u8981\u5360\u7528 $capacity * sizeof(zval) \u5b57\u8282\u7684\u5185\u5b58\u3002 \u4f20\u9012\u7684\u5bb9\u91cf\u5fc5\u987b\u4e3a\u5927\u4e8e\u6216\u7b49\u4e8e1\u7684\u6574\u6570\uff0c\u5426\u5219\u4f7f\u7528\u9ed8\u8ba4\u76841\u3002 \u53c2\u6570 long|null $capacity \u6307\u5b9a channel \u53ef\u4ee5\u5bb9\u7eb3\u7684\u6700\u5927\u6570\u636e\u4e2a\u6570\u3002\u9ed8\u8ba4\u662f 1 \u3002 \u5c0f\u4e8e1 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine\\Channel ; use function Swoole\\Coroutine\\run ; run ( function () { $chan1 = new Channel ( 0 ); var_dump ( $chan1 ); $chan2 = new Channel ( - 1 ); var_dump ( $chan2 ); }); object ( Swoole \\C oroutine \\C hannel ) #3 (2) { [ \"capacity\" ]= > int ( 1 ) [ \"errCode\" ]= > int ( 0 ) } object ( Swoole \\C oroutine \\C hannel ) #4 (2) { [ \"capacity\" ]= > int ( 1 ) [ \"errCode\" ]= > int ( 0 ) } null <?php use Swoole\\Coroutine\\Channel ; use function Swoole\\Coroutine\\run ; run ( function () { $chan = new Channel (); var_dump ( $chan ); }); object ( Swoole \\C oroutine \\C hannel ) #3 (2) { [ \"capacity\" ]= > int ( 1 ) [ \"errCode\" ]= > int ( 0 ) } \u5927\u4e8e1 <?php use Swoole\\Coroutine\\Channel ; use function Swoole\\Coroutine\\run ; run ( function () { $chan = new Channel ( 2 ); var_dump ( $chan ); }); object ( Swoole \\C oroutine \\C hannel ) #3 (2) { [ \"capacity\" ]= > int ( 2 ) [ \"errCode\" ]= > int ( 0 ) }","title":"Channel->__construct"},{"location":"coroutine/channel/__construct/#channel-__construct","text":"Channel \u6784\u9020\u65b9\u6cd5\u3002","title":"Channel-&gt;__construct"},{"location":"coroutine/channel/__construct/#_1","text":"Swoole\\Coroutine\\Channel::__construct <?php public function __construct ( $capacity = 1 ) { } @ param long | null $capacity @ return void \u6ce8\u610f\uff1a \u6b64Channel\u53ef\u4ee5\u6df7\u5408\u5b58\u50a8\u4efb\u610f\u7c7b\u578b\u7684\u6570\u636e\u3002 \u5e95\u5c42\u4f7f\u7528PHP\u5f15\u7528\u8ba1\u6570\u6765\u4fdd\u5b58\u53d8\u91cf\uff0c\u7f13\u5b58\u533a\u53ea\u9700\u8981\u5360\u7528 $capacity * sizeof(zval) \u5b57\u8282\u7684\u5185\u5b58\u3002 \u4f20\u9012\u7684\u5bb9\u91cf\u5fc5\u987b\u4e3a\u5927\u4e8e\u6216\u7b49\u4e8e1\u7684\u6574\u6570\uff0c\u5426\u5219\u4f7f\u7528\u9ed8\u8ba4\u76841\u3002","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/channel/__construct/#_2","text":"","title":"\u53c2\u6570"},{"location":"coroutine/channel/__construct/#longnull-capacity","text":"\u6307\u5b9a channel \u53ef\u4ee5\u5bb9\u7eb3\u7684\u6700\u5927\u6570\u636e\u4e2a\u6570\u3002\u9ed8\u8ba4\u662f 1 \u3002","title":"long|null $capacity"},{"location":"coroutine/channel/__construct/#1","text":"\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine\\Channel ; use function Swoole\\Coroutine\\run ; run ( function () { $chan1 = new Channel ( 0 ); var_dump ( $chan1 ); $chan2 = new Channel ( - 1 ); var_dump ( $chan2 ); }); object ( Swoole \\C oroutine \\C hannel ) #3 (2) { [ \"capacity\" ]= > int ( 1 ) [ \"errCode\" ]= > int ( 0 ) } object ( Swoole \\C oroutine \\C hannel ) #4 (2) { [ \"capacity\" ]= > int ( 1 ) [ \"errCode\" ]= > int ( 0 ) }","title":"\u5c0f\u4e8e1"},{"location":"coroutine/channel/__construct/#null","text":"<?php use Swoole\\Coroutine\\Channel ; use function Swoole\\Coroutine\\run ; run ( function () { $chan = new Channel (); var_dump ( $chan ); }); object ( Swoole \\C oroutine \\C hannel ) #3 (2) { [ \"capacity\" ]= > int ( 1 ) [ \"errCode\" ]= > int ( 0 ) }","title":"null"},{"location":"coroutine/channel/__construct/#1_1","text":"<?php use Swoole\\Coroutine\\Channel ; use function Swoole\\Coroutine\\run ; run ( function () { $chan = new Channel ( 2 ); var_dump ( $chan ); }); object ( Swoole \\C oroutine \\C hannel ) #3 (2) { [ \"capacity\" ]= > int ( 2 ) [ \"errCode\" ]= > int ( 0 ) }","title":"\u5927\u4e8e1"},{"location":"coroutine/channel/pop/","text":"Channel->pop \u5411 Channel \u4e2d\u83b7\u53d6\u51fa\u6570\u636e\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine\\Channel::pop <?php public function pop ( $timeout = null ) { } @ param double $timeout [ optional ] @ return mixed | false \u53c2\u6570 mixed $timeout \u7b49\u5f85\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u79d2\uff08 s \uff09 \u5728\u901a\u9053\u4e3a\u7a7a\u7684\u60c5\u51b5\u4e0b\uff0cpop\u4f1a\u6302\u8d77\u5f53\u524d\u534f\u7a0b\uff0c\u5728\u7ea6\u5b9a\u7684\u65f6\u95f4\u5185\uff0c\u5982\u679c\u6ca1\u6709\u4efb\u4f55\u751f\u4ea7\u8005\u751f\u4ea7\u6570\u636e\uff0c\u5c06\u53d1\u751f\u8d85\u65f6\uff0c\u5e95\u5c42\u4f1a\u6062\u590d\u5f53\u524d\u534f\u7a0b\uff0c pop \u8c03\u7528\u7acb\u5373\u8fd4\u56de false \uff0c\u53d6\u51fa\u5931\u8d25\u3002 <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> pop ( 1 ); var_dump ( $ret ); }); }); bool ( false ) \u8fd4\u56de\u503c \u56e0\u4e3a Channel \u8c03\u7528 pop \u7684\u65f6\u5019\uff0c\u5982\u679c\u5931\u8d25\u4f1a\u8fd4\u56de false \uff0c\u6240\u4ee5\u4e3a\u907f\u514d\u4ea7\u751f\u6b67\u4e49\uff0c\u8bf7\u52ff\u5411\u901a\u9053\u4e2d\u5199\u5165 false \u3002 \u53d6\u51fa Channel \u91cc\u9762\u7684 false \uff1a <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> push ( false ); var_dump ( $ret ); }); go ( function () use ( $chan ) { $ret = $chan -> pop (); var_dump ( $ret ); }); }); bool ( true ) bool ( false ) \u56e0\u4e3a\u5931\u8d25\uff0c\u5bfc\u81f4\u8fd4\u56de false \uff1a <?php use Swoole \\C oroutine \\C hannel ; use function Co \\r un ; run ( function () { $chan = new Channel ( 1 ) ; go ( function () use ( $chan ) { $ret = $chan ->pop ( 1 ) ; var_dump ( $ret ) ; }) ; }) ; bool ( false ) \u5982\u679c\u5fc5\u987b\u8981\u5f80 Channel \u91cc\u9762 push \u4e00\u4e2a false \uff0c\u90a3\u4e48\u5fc5\u987b\u901a\u8fc7 Channel \u7684 errCode \u9519\u8bef\u7801\u6765\u5224\u65ad\u662f\u5426\u53d1\u751f\u4e86\u9519\u8bef\uff1a <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> push ( false ); var_dump ( $ret ); }); go ( function () use ( $chan ) { $ret = $chan -> pop (); if (( $ret === false ) && ( $chan -> errCode < 0 )) { var_dump ( \"error\" ); } else { var_dump ( \"success\" ); } }); }); bool ( true ) string ( 7 ) \"success\" <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> pop ( 1 ); if (( $ret === false ) && ( $chan -> errCode < 0 )) { var_dump ( \"error\" ); } else { var_dump ( \"success\" ); } }); }); string ( 5 ) \"error\"","title":"Channel->pop"},{"location":"coroutine/channel/pop/#channel-pop","text":"\u5411 Channel \u4e2d\u83b7\u53d6\u51fa\u6570\u636e\u3002","title":"Channel-&gt;pop"},{"location":"coroutine/channel/pop/#_1","text":"Swoole\\Coroutine\\Channel::pop <?php public function pop ( $timeout = null ) { } @ param double $timeout [ optional ] @ return mixed | false","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/channel/pop/#_2","text":"","title":"\u53c2\u6570"},{"location":"coroutine/channel/pop/#mixed-timeout","text":"\u7b49\u5f85\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u79d2\uff08 s \uff09 \u5728\u901a\u9053\u4e3a\u7a7a\u7684\u60c5\u51b5\u4e0b\uff0cpop\u4f1a\u6302\u8d77\u5f53\u524d\u534f\u7a0b\uff0c\u5728\u7ea6\u5b9a\u7684\u65f6\u95f4\u5185\uff0c\u5982\u679c\u6ca1\u6709\u4efb\u4f55\u751f\u4ea7\u8005\u751f\u4ea7\u6570\u636e\uff0c\u5c06\u53d1\u751f\u8d85\u65f6\uff0c\u5e95\u5c42\u4f1a\u6062\u590d\u5f53\u524d\u534f\u7a0b\uff0c pop \u8c03\u7528\u7acb\u5373\u8fd4\u56de false \uff0c\u53d6\u51fa\u5931\u8d25\u3002 <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> pop ( 1 ); var_dump ( $ret ); }); }); bool ( false )","title":"mixed $timeout"},{"location":"coroutine/channel/pop/#_3","text":"\u56e0\u4e3a Channel \u8c03\u7528 pop \u7684\u65f6\u5019\uff0c\u5982\u679c\u5931\u8d25\u4f1a\u8fd4\u56de false \uff0c\u6240\u4ee5\u4e3a\u907f\u514d\u4ea7\u751f\u6b67\u4e49\uff0c\u8bf7\u52ff\u5411\u901a\u9053\u4e2d\u5199\u5165 false \u3002 \u53d6\u51fa Channel \u91cc\u9762\u7684 false \uff1a <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> push ( false ); var_dump ( $ret ); }); go ( function () use ( $chan ) { $ret = $chan -> pop (); var_dump ( $ret ); }); }); bool ( true ) bool ( false ) \u56e0\u4e3a\u5931\u8d25\uff0c\u5bfc\u81f4\u8fd4\u56de false \uff1a <?php use Swoole \\C oroutine \\C hannel ; use function Co \\r un ; run ( function () { $chan = new Channel ( 1 ) ; go ( function () use ( $chan ) { $ret = $chan ->pop ( 1 ) ; var_dump ( $ret ) ; }) ; }) ; bool ( false ) \u5982\u679c\u5fc5\u987b\u8981\u5f80 Channel \u91cc\u9762 push \u4e00\u4e2a false \uff0c\u90a3\u4e48\u5fc5\u987b\u901a\u8fc7 Channel \u7684 errCode \u9519\u8bef\u7801\u6765\u5224\u65ad\u662f\u5426\u53d1\u751f\u4e86\u9519\u8bef\uff1a <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> push ( false ); var_dump ( $ret ); }); go ( function () use ( $chan ) { $ret = $chan -> pop (); if (( $ret === false ) && ( $chan -> errCode < 0 )) { var_dump ( \"error\" ); } else { var_dump ( \"success\" ); } }); }); bool ( true ) string ( 7 ) \"success\" <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> pop ( 1 ); if (( $ret === false ) && ( $chan -> errCode < 0 )) { var_dump ( \"error\" ); } else { var_dump ( \"success\" ); } }); }); string ( 5 ) \"error\"","title":"\u8fd4\u56de\u503c"},{"location":"coroutine/channel/push/","text":"Channel->push \u5411 Channel \u4e2d\u5199\u5165\u6570\u636e\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine\\Channel::push <?php public function push ( $data , $timeout = null ) { } @ param mixed $data @ param double $timeout [ optional ] @ return bool \u53c2\u6570 mixed $data \u5f80 Channel \u4e2d\u5b58\u653e\u7684\u6570\u636e\uff08\u53ef\u4ee5\u662f\u4efb\u610f\u7c7b\u578b\u7684\u6570\u636e\uff09\u3002\u4f8b\u5982\uff1a <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 2 ); go ( function () use ( $chan ) { $chan -> push ( \"swoole\" ); $chan -> push ( 1024 ); $chan -> push (( object )[ 'object' , ]); }); go ( function () use ( $chan ) { $data = $chan -> pop (); var_dump ( $data ); $data = $chan -> pop (); var_dump ( $data ); $data = $chan -> pop (); var_dump ( $data ); }); }); string ( 6 ) \"swoole\" int ( 1024 ) object ( stdClass ) #5 (1) { [ \"0\" ]= > string ( 6 ) \"object\" } mixed $timeout \u7b49\u5f85\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u79d2\uff08 s \uff09 \u5728\u901a\u9053\u5df2\u6ee1\u7684\u60c5\u51b5\u4e0b\uff0cpush\u4f1a\u6302\u8d77\u5f53\u524d\u534f\u7a0b\uff0c\u5728\u7ea6\u5b9a\u7684\u65f6\u95f4\u5185\uff0c\u5982\u679c\u6ca1\u6709\u4efb\u4f55\u6d88\u8d39\u8005\u6d88\u8d39\u6570\u636e\uff0c\u5c06\u53d1\u751f\u8d85\u65f6\uff0c\u5e95\u5c42\u4f1a\u6062\u590d\u5f53\u524d\u534f\u7a0b\uff0cpush\u8c03\u7528\u7acb\u5373\u8fd4\u56defalse\uff0c\u5199\u5165\u5931\u8d25\u3002 \u4e0d\u8bbe\u7f6etimeout <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> push ( \"swoole\" ); var_dump ( $ret ); $ret = $chan -> push ( 1024 ); var_dump ( $ret ); }); var_dump ( \"here\" ); }); bool ( true ) string ( 4 ) \"here\" \u6b64\u65f6 1024 \u6ca1\u6709\u88ab push \u8fdb Channel \u91cc\u9762\uff0c\u5e76\u4e14\u534f\u7a0b\u88ab yield \u51fa\u6765\u4e86\u3002 \u8bbe\u7f6etimeout <?php use Swoole\\Coroutine ; use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> push ( \"swoole\" ); var_dump ( $ret ); $ret = $chan -> push ( 1024 , 1 ); var_dump ( $ret ); }); var_dump ( \"here\" ); }); bool ( true ) string ( 4 ) \"here\" bool ( false ) \u6b64\u65f6\uff0c\u56e0\u4e3a timeout \u7684\u65f6\u95f4\u5230\u4e86\uff0c\u4f46\u662f\u4f9d\u7136\u6ca1\u6709\u6d88\u8d39\u8005\u534f\u7a0b\u53bb\u4ece\u8fd9\u4e2a Channel \u91cc\u9762 pop \u51fa\u6570\u636e\uff0c\u6240\u4ee5\u7b2c\u4e8c\u4e2a push \u8fd4\u56de false \u3002 \u8fd4\u56de\u503c \u56e0\u4e3a Channel \u8c03\u7528 pop \u7684\u65f6\u5019\uff0c\u5982\u679c\u5931\u8d25\u4f1a\u8fd4\u56de false \uff0c\u6240\u4ee5\u4e3a\u907f\u514d\u4ea7\u751f\u6b67\u4e49\uff0c\u8bf7\u52ff\u5411\u901a\u9053\u4e2d\u5199\u5165 false \u3002 \u53d6\u51fa Channel \u91cc\u9762\u7684 false \uff1a <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> push ( false ); var_dump ( $ret ); }); go ( function () use ( $chan ) { $ret = $chan -> pop (); var_dump ( $ret ); }); }); bool ( true ) bool ( false ) \u56e0\u4e3a\u5931\u8d25\uff0c\u5bfc\u81f4\u8fd4\u56de false \uff1a <?php use Swoole \\C oroutine \\C hannel ; use function Co \\r un ; run ( function () { $chan = new Channel ( 1 ) ; go ( function () use ( $chan ) { $ret = $chan ->pop ( 1 ) ; var_dump ( $ret ) ; }) ; }) ; bool ( false ) \u5982\u679c\u5fc5\u987b\u8981\u5f80 Channel \u91cc\u9762 push \u4e00\u4e2a false \uff0c\u90a3\u4e48\u5fc5\u987b\u901a\u8fc7 Channel \u7684 errCode \u9519\u8bef\u7801\u6765\u5224\u65ad\u662f\u5426\u53d1\u751f\u4e86\u9519\u8bef\uff1a <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> push ( false ); var_dump ( $ret ); }); go ( function () use ( $chan ) { $ret = $chan -> pop (); if (( $ret === false ) && ( $chan -> errCode < 0 )) { var_dump ( \"error\" ); } else { var_dump ( \"success\" ); } }); }); bool ( true ) string ( 7 ) \"success\" <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> pop ( 1 ); if (( $ret === false ) && ( $chan -> errCode < 0 )) { var_dump ( \"error\" ); } else { var_dump ( \"success\" ); } }); }); string ( 5 ) \"error\"","title":"Channel->push"},{"location":"coroutine/channel/push/#channel-push","text":"\u5411 Channel \u4e2d\u5199\u5165\u6570\u636e\u3002","title":"Channel-&gt;push"},{"location":"coroutine/channel/push/#_1","text":"Swoole\\Coroutine\\Channel::push <?php public function push ( $data , $timeout = null ) { } @ param mixed $data @ param double $timeout [ optional ] @ return bool","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/channel/push/#_2","text":"","title":"\u53c2\u6570"},{"location":"coroutine/channel/push/#mixed-data","text":"\u5f80 Channel \u4e2d\u5b58\u653e\u7684\u6570\u636e\uff08\u53ef\u4ee5\u662f\u4efb\u610f\u7c7b\u578b\u7684\u6570\u636e\uff09\u3002\u4f8b\u5982\uff1a <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 2 ); go ( function () use ( $chan ) { $chan -> push ( \"swoole\" ); $chan -> push ( 1024 ); $chan -> push (( object )[ 'object' , ]); }); go ( function () use ( $chan ) { $data = $chan -> pop (); var_dump ( $data ); $data = $chan -> pop (); var_dump ( $data ); $data = $chan -> pop (); var_dump ( $data ); }); }); string ( 6 ) \"swoole\" int ( 1024 ) object ( stdClass ) #5 (1) { [ \"0\" ]= > string ( 6 ) \"object\" }","title":"mixed $data"},{"location":"coroutine/channel/push/#mixed-timeout","text":"\u7b49\u5f85\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u79d2\uff08 s \uff09 \u5728\u901a\u9053\u5df2\u6ee1\u7684\u60c5\u51b5\u4e0b\uff0cpush\u4f1a\u6302\u8d77\u5f53\u524d\u534f\u7a0b\uff0c\u5728\u7ea6\u5b9a\u7684\u65f6\u95f4\u5185\uff0c\u5982\u679c\u6ca1\u6709\u4efb\u4f55\u6d88\u8d39\u8005\u6d88\u8d39\u6570\u636e\uff0c\u5c06\u53d1\u751f\u8d85\u65f6\uff0c\u5e95\u5c42\u4f1a\u6062\u590d\u5f53\u524d\u534f\u7a0b\uff0cpush\u8c03\u7528\u7acb\u5373\u8fd4\u56defalse\uff0c\u5199\u5165\u5931\u8d25\u3002","title":"mixed $timeout"},{"location":"coroutine/channel/push/#timeout","text":"<?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> push ( \"swoole\" ); var_dump ( $ret ); $ret = $chan -> push ( 1024 ); var_dump ( $ret ); }); var_dump ( \"here\" ); }); bool ( true ) string ( 4 ) \"here\" \u6b64\u65f6 1024 \u6ca1\u6709\u88ab push \u8fdb Channel \u91cc\u9762\uff0c\u5e76\u4e14\u534f\u7a0b\u88ab yield \u51fa\u6765\u4e86\u3002","title":"\u4e0d\u8bbe\u7f6etimeout"},{"location":"coroutine/channel/push/#timeout_1","text":"<?php use Swoole\\Coroutine ; use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> push ( \"swoole\" ); var_dump ( $ret ); $ret = $chan -> push ( 1024 , 1 ); var_dump ( $ret ); }); var_dump ( \"here\" ); }); bool ( true ) string ( 4 ) \"here\" bool ( false ) \u6b64\u65f6\uff0c\u56e0\u4e3a timeout \u7684\u65f6\u95f4\u5230\u4e86\uff0c\u4f46\u662f\u4f9d\u7136\u6ca1\u6709\u6d88\u8d39\u8005\u534f\u7a0b\u53bb\u4ece\u8fd9\u4e2a Channel \u91cc\u9762 pop \u51fa\u6570\u636e\uff0c\u6240\u4ee5\u7b2c\u4e8c\u4e2a push \u8fd4\u56de false \u3002","title":"\u8bbe\u7f6etimeout"},{"location":"coroutine/channel/push/#_3","text":"\u56e0\u4e3a Channel \u8c03\u7528 pop \u7684\u65f6\u5019\uff0c\u5982\u679c\u5931\u8d25\u4f1a\u8fd4\u56de false \uff0c\u6240\u4ee5\u4e3a\u907f\u514d\u4ea7\u751f\u6b67\u4e49\uff0c\u8bf7\u52ff\u5411\u901a\u9053\u4e2d\u5199\u5165 false \u3002 \u53d6\u51fa Channel \u91cc\u9762\u7684 false \uff1a <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> push ( false ); var_dump ( $ret ); }); go ( function () use ( $chan ) { $ret = $chan -> pop (); var_dump ( $ret ); }); }); bool ( true ) bool ( false ) \u56e0\u4e3a\u5931\u8d25\uff0c\u5bfc\u81f4\u8fd4\u56de false \uff1a <?php use Swoole \\C oroutine \\C hannel ; use function Co \\r un ; run ( function () { $chan = new Channel ( 1 ) ; go ( function () use ( $chan ) { $ret = $chan ->pop ( 1 ) ; var_dump ( $ret ) ; }) ; }) ; bool ( false ) \u5982\u679c\u5fc5\u987b\u8981\u5f80 Channel \u91cc\u9762 push \u4e00\u4e2a false \uff0c\u90a3\u4e48\u5fc5\u987b\u901a\u8fc7 Channel \u7684 errCode \u9519\u8bef\u7801\u6765\u5224\u65ad\u662f\u5426\u53d1\u751f\u4e86\u9519\u8bef\uff1a <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> push ( false ); var_dump ( $ret ); }); go ( function () use ( $chan ) { $ret = $chan -> pop (); if (( $ret === false ) && ( $chan -> errCode < 0 )) { var_dump ( \"error\" ); } else { var_dump ( \"success\" ); } }); }); bool ( true ) string ( 7 ) \"success\" <?php use Swoole\\Coroutine\\Channel ; use function Co\\run ; run ( function () { $chan = new Channel ( 1 ); go ( function () use ( $chan ) { $ret = $chan -> pop ( 1 ); if (( $ret === false ) && ( $chan -> errCode < 0 )) { var_dump ( \"error\" ); } else { var_dump ( \"success\" ); } }); }); string ( 5 ) \"error\"","title":"\u8fd4\u56de\u503c"},{"location":"coroutine/coroutine/create/","text":"Coroutine::create Coroutine::create \u7528\u6765\u521b\u5efa\u4e00\u4e2a\u534f\u7a0b\uff0c\u5e76\u4e14\u7acb\u9a6c\u6267\u884c\u8fd9\u4e2a\u534f\u7a0b\u3002 \u65b9\u6cd5\u539f\u578b <?php public static function create ( callable $func , ... $params ) { } @ param callable $func @ param mixed ... $params @ return mixed \u8fd9\u4e2a\u65b9\u6cd5\u6709\u4e00\u4e2a\u522b\u540d\uff0c go \uff1a <?php function go ( $func , $params = null ) { } @ param callable $func @ param mixed ... $params @ return mixed \u53c2\u6570 callable $func \u4ee3\u8868\u4e00\u4e2a PHP \u51fd\u6570\u6216\u8005\u65b9\u6cd5\u3002 \u666e\u901a\u51fd\u6570 <?php function task () { echo 'swoole' . PHP_EOL ; } go ( 'task' ); swoole \u533f\u540d\u51fd\u6570 <?php go ( function () { echo 'swoole' . PHP_EOL ; }); swoole \u975e\u9759\u6001\u65b9\u6cd5 <?php class Codinghuang { public function task () { echo 'swoole' . PHP_EOL ; } } $obj = new Codinghuang ; go ([ $obj , 'task' ]); swoole \u9759\u6001\u65b9\u6cd5 <?php class Codinghuang { public static function task () { echo 'swoole' . PHP_EOL ; } } go ([ Codinghuang :: class , 'task' ]); swoole \u5728\u7c7b\u7684\u5185\u90e8\u8c03\u7528\u975e\u9759\u6001\u65b9\u6cd5 <?php class Codinghuang { public function test () { go ([ $this , 'task' ]); } public function task () { echo 'swoole' . PHP_EOL ; } } $obj = new Codinghuang ; $obj -> test (); swoole \u5728\u7c7b\u7684\u5185\u90e8\u8c03\u7528\u9759\u6001\u65b9\u6cd5 <?php class Codinghuang { public function test () { go ([ self :: class , 'task' ]); } public static function task () { echo 'swoole' . PHP_EOL ; } } $obj = new Codinghuang ; $obj -> test (); swoole mixed ...$params \u4f20\u9012\u7ed9\u534f\u7a0b\u4efb\u52a1\u51fd\u6570\u7684\u53c2\u6570\uff0c\u53c2\u6570\u4e2a\u6570\u662f\u53ef\u53d8\u7684\u3002 \u7ed9\u666e\u901a\u51fd\u6570\u4f20\u9012\u53c2\u6570 <?php function task ( $param1 , $param2 ) { var_dump ( $param1 ); var_dump ( $param2 ); } go ( 'task' , 1 , 'swoole' ); int ( 1 ) string ( 6 ) \"swoole\" \u7ed9\u533f\u540d\u51fd\u6570\u4f20\u9012\u53c2\u6570 <?php go ( function ( $param1 , $param2 ) { var_dump ( $param1 ); var_dump ( $param2 ); }, 1 , 'swoole' ); int ( 1 ) string ( 6 ) \"swoole\" \u4f7f\u7528\u95ed\u5305 <?php $param1 = 1 ; $param2 = 'swoole' ; go ( function () use ( $param1 , $param2 ) { var_dump ( $param1 ); var_dump ( $param2 ); }); int ( 1 ) string ( 6 ) \"swoole\"","title":"Coroutine::create"},{"location":"coroutine/coroutine/create/#coroutinecreate","text":"Coroutine::create \u7528\u6765\u521b\u5efa\u4e00\u4e2a\u534f\u7a0b\uff0c\u5e76\u4e14\u7acb\u9a6c\u6267\u884c\u8fd9\u4e2a\u534f\u7a0b\u3002","title":"Coroutine::create"},{"location":"coroutine/coroutine/create/#_1","text":"<?php public static function create ( callable $func , ... $params ) { } @ param callable $func @ param mixed ... $params @ return mixed \u8fd9\u4e2a\u65b9\u6cd5\u6709\u4e00\u4e2a\u522b\u540d\uff0c go \uff1a <?php function go ( $func , $params = null ) { } @ param callable $func @ param mixed ... $params @ return mixed","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/create/#_2","text":"","title":"\u53c2\u6570"},{"location":"coroutine/coroutine/create/#callable-func","text":"\u4ee3\u8868\u4e00\u4e2a PHP \u51fd\u6570\u6216\u8005\u65b9\u6cd5\u3002","title":"callable $func"},{"location":"coroutine/coroutine/create/#_3","text":"<?php function task () { echo 'swoole' . PHP_EOL ; } go ( 'task' ); swoole","title":"\u666e\u901a\u51fd\u6570"},{"location":"coroutine/coroutine/create/#_4","text":"<?php go ( function () { echo 'swoole' . PHP_EOL ; }); swoole","title":"\u533f\u540d\u51fd\u6570"},{"location":"coroutine/coroutine/create/#_5","text":"<?php class Codinghuang { public function task () { echo 'swoole' . PHP_EOL ; } } $obj = new Codinghuang ; go ([ $obj , 'task' ]); swoole","title":"\u975e\u9759\u6001\u65b9\u6cd5"},{"location":"coroutine/coroutine/create/#_6","text":"<?php class Codinghuang { public static function task () { echo 'swoole' . PHP_EOL ; } } go ([ Codinghuang :: class , 'task' ]); swoole","title":"\u9759\u6001\u65b9\u6cd5"},{"location":"coroutine/coroutine/create/#_7","text":"<?php class Codinghuang { public function test () { go ([ $this , 'task' ]); } public function task () { echo 'swoole' . PHP_EOL ; } } $obj = new Codinghuang ; $obj -> test (); swoole","title":"\u5728\u7c7b\u7684\u5185\u90e8\u8c03\u7528\u975e\u9759\u6001\u65b9\u6cd5"},{"location":"coroutine/coroutine/create/#_8","text":"<?php class Codinghuang { public function test () { go ([ self :: class , 'task' ]); } public static function task () { echo 'swoole' . PHP_EOL ; } } $obj = new Codinghuang ; $obj -> test (); swoole","title":"\u5728\u7c7b\u7684\u5185\u90e8\u8c03\u7528\u9759\u6001\u65b9\u6cd5"},{"location":"coroutine/coroutine/create/#mixed-params","text":"\u4f20\u9012\u7ed9\u534f\u7a0b\u4efb\u52a1\u51fd\u6570\u7684\u53c2\u6570\uff0c\u53c2\u6570\u4e2a\u6570\u662f\u53ef\u53d8\u7684\u3002","title":"mixed ...$params"},{"location":"coroutine/coroutine/create/#_9","text":"<?php function task ( $param1 , $param2 ) { var_dump ( $param1 ); var_dump ( $param2 ); } go ( 'task' , 1 , 'swoole' ); int ( 1 ) string ( 6 ) \"swoole\"","title":"\u7ed9\u666e\u901a\u51fd\u6570\u4f20\u9012\u53c2\u6570"},{"location":"coroutine/coroutine/create/#_10","text":"<?php go ( function ( $param1 , $param2 ) { var_dump ( $param1 ); var_dump ( $param2 ); }, 1 , 'swoole' ); int ( 1 ) string ( 6 ) \"swoole\"","title":"\u7ed9\u533f\u540d\u51fd\u6570\u4f20\u9012\u53c2\u6570"},{"location":"coroutine/coroutine/create/#_11","text":"<?php $param1 = 1 ; $param2 = 'swoole' ; go ( function () use ( $param1 , $param2 ) { var_dump ( $param1 ); var_dump ( $param2 ); }); int ( 1 ) string ( 6 ) \"swoole\"","title":"\u4f7f\u7528\u95ed\u5305"},{"location":"coroutine/coroutine/defer/","text":"Coroutine::defer Coroutine::defer \u7528\u6765\u5728\u534f\u7a0b\u5173\u95ed\u4e4b\u524d(\u5373\u534f\u7a0b\u51fd\u6570\u6267\u884c\u5b8c\u6bd5\u65f6)\u8c03\u7528\u88ab defer \u6ce8\u518c\u7684\u4ee3\u7801\u3002 \u6ce8\u610f\uff0c\u56e0\u4e3a defer \u4e00\u822c\u7528\u4e8e\u8d44\u6e90\u7684\u91ca\u653e\uff0c\u6240\u4ee5\u5b83\u7684\u8c03\u7528\u987a\u5e8f\u662f\u5148\u6ce8\u518cdefer\u7684\u540e\u6267\u884c\u3002\u9006\u5e8f\u7b26\u5408\u8d44\u6e90\u91ca\u653e\u7684\u6b63\u786e\u903b\u8f91, \u540e\u7533\u8bf7\u7684\u8d44\u6e90\u53ef\u80fd\u662f\u57fa\u4e8e\u5148\u7533\u8bf7\u7684\u8d44\u6e90\u7684, \u5982\u5148\u91ca\u653e\u5148\u7533\u8bf7\u7684\u8d44\u6e90, \u540e\u7533\u8bf7\u7684\u8d44\u6e90\u53ef\u80fd\u5c31\u96be\u4ee5\u91ca\u653e\u3002\u53e6\u5916\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u534f\u7a0b\u5185\u629b\u51fa\u4e86\u5f02\u5e38\uff0c\u5df2\u6ce8\u518c\u7684defer\u4e5f\u4f1a\u88ab\u6267\u884c\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::defer <?php public static function defer ( $callback ) { } @ param callable $func @ return mixed \u8fd9\u4e2a\u65b9\u6cd5\u6709\u4e00\u4e2a\u522b\u540d\uff0c defer \uff1a defer <?php function defer ( $callback ) { } @ param callable $func @ return mixed \u53c2\u6570 callable $func \u4ee3\u8868\u4e00\u4e2a PHP \u51fd\u6570\u6216\u8005\u65b9\u6cd5\u3002 \u666e\u901a\u51fd\u6570 <?php function task1 () { echo 'task1' . PHP_EOL ; } function task2 () { echo 'task2' . PHP_EOL ; } Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; Swoole\\Coroutine :: defer ( 'task1' ); Swoole\\Coroutine :: defer ( 'task2' ); echo '2' . PHP_EOL ; }); }); 1 2 task2 task1 \u533f\u540d\u51fd\u6570 <?php Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; Swoole\\Coroutine :: defer ( function () { echo 'task1' . PHP_EOL ; }); Swoole\\Coroutine :: defer ( function () { echo 'task2' . PHP_EOL ; }); echo '2' . PHP_EOL ; }); }); 1 2 task2 task1 \u975e\u9759\u6001\u65b9\u6cd5 <?php class Codinghuang { public function task1 () { echo 'task1' . PHP_EOL ; } public function task2 () { echo 'task2' . PHP_EOL ; } } Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; $obj = new Codinghuang ; Swoole\\Coroutine :: defer ([ $obj , 'task1' ]); Swoole\\Coroutine :: defer ([ $obj , 'task2' ]); echo '2' . PHP_EOL ; }); }); 1 2 task2 task1 \u9759\u6001\u65b9\u6cd5 <?php class Codinghuang { public static function task1 () { echo 'task1' . PHP_EOL ; } public static function task2 () { echo 'task2' . PHP_EOL ; } } Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; Swoole\\Coroutine :: defer ([ Codinghuang :: class , 'task1' ]); Swoole\\Coroutine :: defer ([ Codinghuang :: class , 'task2' ]); echo '2' . PHP_EOL ; }); }); 1 2 task2 task1 \u5728\u7c7b\u7684\u5185\u90e8\u8c03\u7528\u975e\u9759\u6001\u65b9\u6cd5 <?php class Codinghuang { public function run () { Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; Swoole\\Coroutine :: defer ([ $this , 'task1' ]); Swoole\\Coroutine :: defer ([ $this , 'task2' ]); echo '2' . PHP_EOL ; }); }); } public function task1 () { echo 'task1' . PHP_EOL ; } public function task2 () { echo 'task2' . PHP_EOL ; } } $obj = new Codinghuang ; $obj -> run (); 1 2 task2 task1 \u5728\u7c7b\u7684\u5185\u90e8\u8c03\u7528\u9759\u6001\u65b9\u6cd5 <?php class Codinghuang { public function run () { Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; Swoole\\Coroutine :: defer ([ self :: class , 'task1' ]); Swoole\\Coroutine :: defer ([ self :: class , 'task2' ]); echo '2' . PHP_EOL ; }); }); } public static function task1 () { echo 'task1' . PHP_EOL ; } public static function task2 () { echo 'task2' . PHP_EOL ; } } $obj = new Codinghuang ; $obj -> run (); 1 2 task2 task1 \u4f7f\u7528\u534f\u7a0b\u7684\u8fd4\u56de\u503c\u4f5c\u4e3a\u53c2\u6570 <?php Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; Swoole\\Coroutine :: defer ( function ( $param ) { var_dump ( $param ); }); echo '2' . PHP_EOL ; return \"swoole\" ; }); }); 1 2 string ( 6 ) \"swoole\"","title":"Coroutine::defer"},{"location":"coroutine/coroutine/defer/#coroutinedefer","text":"Coroutine::defer \u7528\u6765\u5728\u534f\u7a0b\u5173\u95ed\u4e4b\u524d(\u5373\u534f\u7a0b\u51fd\u6570\u6267\u884c\u5b8c\u6bd5\u65f6)\u8c03\u7528\u88ab defer \u6ce8\u518c\u7684\u4ee3\u7801\u3002 \u6ce8\u610f\uff0c\u56e0\u4e3a defer \u4e00\u822c\u7528\u4e8e\u8d44\u6e90\u7684\u91ca\u653e\uff0c\u6240\u4ee5\u5b83\u7684\u8c03\u7528\u987a\u5e8f\u662f\u5148\u6ce8\u518cdefer\u7684\u540e\u6267\u884c\u3002\u9006\u5e8f\u7b26\u5408\u8d44\u6e90\u91ca\u653e\u7684\u6b63\u786e\u903b\u8f91, \u540e\u7533\u8bf7\u7684\u8d44\u6e90\u53ef\u80fd\u662f\u57fa\u4e8e\u5148\u7533\u8bf7\u7684\u8d44\u6e90\u7684, \u5982\u5148\u91ca\u653e\u5148\u7533\u8bf7\u7684\u8d44\u6e90, \u540e\u7533\u8bf7\u7684\u8d44\u6e90\u53ef\u80fd\u5c31\u96be\u4ee5\u91ca\u653e\u3002\u53e6\u5916\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u534f\u7a0b\u5185\u629b\u51fa\u4e86\u5f02\u5e38\uff0c\u5df2\u6ce8\u518c\u7684defer\u4e5f\u4f1a\u88ab\u6267\u884c\u3002","title":"Coroutine::defer"},{"location":"coroutine/coroutine/defer/#_1","text":"Swoole\\Coroutine::defer <?php public static function defer ( $callback ) { } @ param callable $func @ return mixed \u8fd9\u4e2a\u65b9\u6cd5\u6709\u4e00\u4e2a\u522b\u540d\uff0c defer \uff1a defer <?php function defer ( $callback ) { } @ param callable $func @ return mixed","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/defer/#_2","text":"","title":"\u53c2\u6570"},{"location":"coroutine/coroutine/defer/#callable-func","text":"\u4ee3\u8868\u4e00\u4e2a PHP \u51fd\u6570\u6216\u8005\u65b9\u6cd5\u3002","title":"callable $func"},{"location":"coroutine/coroutine/defer/#_3","text":"<?php function task1 () { echo 'task1' . PHP_EOL ; } function task2 () { echo 'task2' . PHP_EOL ; } Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; Swoole\\Coroutine :: defer ( 'task1' ); Swoole\\Coroutine :: defer ( 'task2' ); echo '2' . PHP_EOL ; }); }); 1 2 task2 task1","title":"\u666e\u901a\u51fd\u6570"},{"location":"coroutine/coroutine/defer/#_4","text":"<?php Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; Swoole\\Coroutine :: defer ( function () { echo 'task1' . PHP_EOL ; }); Swoole\\Coroutine :: defer ( function () { echo 'task2' . PHP_EOL ; }); echo '2' . PHP_EOL ; }); }); 1 2 task2 task1","title":"\u533f\u540d\u51fd\u6570"},{"location":"coroutine/coroutine/defer/#_5","text":"<?php class Codinghuang { public function task1 () { echo 'task1' . PHP_EOL ; } public function task2 () { echo 'task2' . PHP_EOL ; } } Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; $obj = new Codinghuang ; Swoole\\Coroutine :: defer ([ $obj , 'task1' ]); Swoole\\Coroutine :: defer ([ $obj , 'task2' ]); echo '2' . PHP_EOL ; }); }); 1 2 task2 task1","title":"\u975e\u9759\u6001\u65b9\u6cd5"},{"location":"coroutine/coroutine/defer/#_6","text":"<?php class Codinghuang { public static function task1 () { echo 'task1' . PHP_EOL ; } public static function task2 () { echo 'task2' . PHP_EOL ; } } Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; Swoole\\Coroutine :: defer ([ Codinghuang :: class , 'task1' ]); Swoole\\Coroutine :: defer ([ Codinghuang :: class , 'task2' ]); echo '2' . PHP_EOL ; }); }); 1 2 task2 task1","title":"\u9759\u6001\u65b9\u6cd5"},{"location":"coroutine/coroutine/defer/#_7","text":"<?php class Codinghuang { public function run () { Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; Swoole\\Coroutine :: defer ([ $this , 'task1' ]); Swoole\\Coroutine :: defer ([ $this , 'task2' ]); echo '2' . PHP_EOL ; }); }); } public function task1 () { echo 'task1' . PHP_EOL ; } public function task2 () { echo 'task2' . PHP_EOL ; } } $obj = new Codinghuang ; $obj -> run (); 1 2 task2 task1","title":"\u5728\u7c7b\u7684\u5185\u90e8\u8c03\u7528\u975e\u9759\u6001\u65b9\u6cd5"},{"location":"coroutine/coroutine/defer/#_8","text":"<?php class Codinghuang { public function run () { Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; Swoole\\Coroutine :: defer ([ self :: class , 'task1' ]); Swoole\\Coroutine :: defer ([ self :: class , 'task2' ]); echo '2' . PHP_EOL ; }); }); } public static function task1 () { echo 'task1' . PHP_EOL ; } public static function task2 () { echo 'task2' . PHP_EOL ; } } $obj = new Codinghuang ; $obj -> run (); 1 2 task2 task1","title":"\u5728\u7c7b\u7684\u5185\u90e8\u8c03\u7528\u9759\u6001\u65b9\u6cd5"},{"location":"coroutine/coroutine/defer/#_9","text":"<?php Swoole\\Coroutine\\run ( function () { go ( function () { echo '1' . PHP_EOL ; Swoole\\Coroutine :: defer ( function ( $param ) { var_dump ( $param ); }); echo '2' . PHP_EOL ; return \"swoole\" ; }); }); 1 2 string ( 6 ) \"swoole\"","title":"\u4f7f\u7528\u534f\u7a0b\u7684\u8fd4\u56de\u503c\u4f5c\u4e3a\u53c2\u6570"},{"location":"coroutine/coroutine/disableScheduler/","text":"Coroutine::disableScheduler \u5173\u95ed \u5f53\u524d\u534f\u7a0b \u7684 CPU \u5bc6\u96c6\u578b\u8c03\u5ea6\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::disableScheduler <?php public static function disableScheduler () { } @ return mixed \u65e0\u53c2\u6570 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; ini_set ( \"swoole.enable_preemptive_scheduler\" , \"1\" ); run ( function () { go ( function () { Coroutine :: disableScheduler (); while ( true ) { } }); var_dump ( 'swoole' ); }); \u53ef\u4ee5\u53d1\u73b0\uff0c\u662f\u4e0d\u4f1a\u8df3\u51fa\u6b7b\u5faa\u73af\u7684\u3002","title":"Coroutine::disableScheduler"},{"location":"coroutine/coroutine/disableScheduler/#coroutinedisablescheduler","text":"\u5173\u95ed \u5f53\u524d\u534f\u7a0b \u7684 CPU \u5bc6\u96c6\u578b\u8c03\u5ea6\u3002","title":"Coroutine::disableScheduler"},{"location":"coroutine/coroutine/disableScheduler/#_1","text":"Swoole\\Coroutine::disableScheduler <?php public static function disableScheduler () { } @ return mixed","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/disableScheduler/#_2","text":"\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; ini_set ( \"swoole.enable_preemptive_scheduler\" , \"1\" ); run ( function () { go ( function () { Coroutine :: disableScheduler (); while ( true ) { } }); var_dump ( 'swoole' ); }); \u53ef\u4ee5\u53d1\u73b0\uff0c\u662f\u4e0d\u4f1a\u8df3\u51fa\u6b7b\u5faa\u73af\u7684\u3002","title":"\u65e0\u53c2\u6570"},{"location":"coroutine/coroutine/enableScheduler/","text":"Coroutine::enableScheduler \u8ba9\u5f53\u524d\u534f\u7a0b\u652f\u6301 CPU \u5bc6\u96c6\u578b\u8c03\u5ea6\uff0c\u9ed8\u8ba4\u662f\u5f00\u542f\u7684\u3002 \u6ce8\u610f\uff0cenableScheduler\u751f\u6548\u7684\u524d\u63d0\u662f\u6269\u5c55\u672c\u8eab\u5f00\u542f\u534f\u7a0bCPU\u5bc6\u96c6\u578b\u8c03\u5ea6\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u6269\u5c55\u5f00\u542f\u4e86\u534f\u7a0bCPU\u5bc6\u96c6\u578b\u8c03\u5ea6\u7684\u65f6\u5019\uff0c\u4f1a\u4e13\u95e8\u8d77\u4e00\u4e2a\u8c03\u5ea6\u534f\u7a0b\u53bb\u5bf9\u5360\u7528CPU\u8d44\u6e90\u8fc7\u4e45\u7684\u534f\u7a0b\u8fdb\u884c\u4e2d\u65ad\u7684\u64cd\u4f5c\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::enableScheduler <?php public static function enableScheduler () { } @ return mixed \u65e0\u53c2\u6570 \u5f00\u542f\u6269\u5c55\u7684\u534f\u7a0bCPU\u5bc6\u96c6\u578b\u8c03\u5ea6 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; ini_set ( \"swoole.enable_preemptive_scheduler\" , \"1\" ); run ( function () { go ( function () { Coroutine :: enableScheduler (); while ( true ) { } }); var_dump ( \"swoole\" ); }); string ( 6 ) \"swoole\" \u6b64\u65f6\uff0c\u4f1a\u8df3\u51fa\u6b7b\u5faa\u73af\u3002\uff08\u6ce8\u610f\uff0c\u8fd8\u4f1a\u56de\u5230\u5faa\u73af\u91cc\u9762\uff09 \u5b9e\u9645\u4e0a\uff0c\u534f\u7a0b\u9ed8\u8ba4\u662f\u5f00\u542f CPU \u5bc6\u96c6\u578b\u8c03\u5ea6\u7684\u3002\u4f8b\u5982\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; ini_set ( \"swoole.enable_preemptive_scheduler\" , \"1\" ); run ( function () { go ( function () { while ( true ) { } }); var_dump ( \"swoole\" ); }); string ( 6 ) \"swoole\" \u4f9d\u7136\u4f1a\u8df3\u51fa\u6b7b\u5faa\u73af\u3002 \u5173\u95ed\u6269\u5c55\u7684\u534f\u7a0bCPU\u5bc6\u96c6\u578b\u8c03\u5ea6 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { Coroutine :: enableScheduler (); while ( true ) { } }); var_dump ( \"swoole\" ); }); \u53ef\u4ee5\u53d1\u73b0\uff0c\u662f\u4e0d\u4f1a\u8df3\u51fa\u6b7b\u5faa\u73af\u7684\u3002","title":"Coroutine::enableScheduler"},{"location":"coroutine/coroutine/enableScheduler/#coroutineenablescheduler","text":"\u8ba9\u5f53\u524d\u534f\u7a0b\u652f\u6301 CPU \u5bc6\u96c6\u578b\u8c03\u5ea6\uff0c\u9ed8\u8ba4\u662f\u5f00\u542f\u7684\u3002 \u6ce8\u610f\uff0cenableScheduler\u751f\u6548\u7684\u524d\u63d0\u662f\u6269\u5c55\u672c\u8eab\u5f00\u542f\u534f\u7a0bCPU\u5bc6\u96c6\u578b\u8c03\u5ea6\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u6269\u5c55\u5f00\u542f\u4e86\u534f\u7a0bCPU\u5bc6\u96c6\u578b\u8c03\u5ea6\u7684\u65f6\u5019\uff0c\u4f1a\u4e13\u95e8\u8d77\u4e00\u4e2a\u8c03\u5ea6\u534f\u7a0b\u53bb\u5bf9\u5360\u7528CPU\u8d44\u6e90\u8fc7\u4e45\u7684\u534f\u7a0b\u8fdb\u884c\u4e2d\u65ad\u7684\u64cd\u4f5c\u3002","title":"Coroutine::enableScheduler"},{"location":"coroutine/coroutine/enableScheduler/#_1","text":"Swoole\\Coroutine::enableScheduler <?php public static function enableScheduler () { } @ return mixed","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/enableScheduler/#_2","text":"","title":"\u65e0\u53c2\u6570"},{"location":"coroutine/coroutine/enableScheduler/#cpu","text":"\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; ini_set ( \"swoole.enable_preemptive_scheduler\" , \"1\" ); run ( function () { go ( function () { Coroutine :: enableScheduler (); while ( true ) { } }); var_dump ( \"swoole\" ); }); string ( 6 ) \"swoole\" \u6b64\u65f6\uff0c\u4f1a\u8df3\u51fa\u6b7b\u5faa\u73af\u3002\uff08\u6ce8\u610f\uff0c\u8fd8\u4f1a\u56de\u5230\u5faa\u73af\u91cc\u9762\uff09 \u5b9e\u9645\u4e0a\uff0c\u534f\u7a0b\u9ed8\u8ba4\u662f\u5f00\u542f CPU \u5bc6\u96c6\u578b\u8c03\u5ea6\u7684\u3002\u4f8b\u5982\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; ini_set ( \"swoole.enable_preemptive_scheduler\" , \"1\" ); run ( function () { go ( function () { while ( true ) { } }); var_dump ( \"swoole\" ); }); string ( 6 ) \"swoole\" \u4f9d\u7136\u4f1a\u8df3\u51fa\u6b7b\u5faa\u73af\u3002","title":"\u5f00\u542f\u6269\u5c55\u7684\u534f\u7a0bCPU\u5bc6\u96c6\u578b\u8c03\u5ea6"},{"location":"coroutine/coroutine/enableScheduler/#cpu_1","text":"\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { Coroutine :: enableScheduler (); while ( true ) { } }); var_dump ( \"swoole\" ); }); \u53ef\u4ee5\u53d1\u73b0\uff0c\u662f\u4e0d\u4f1a\u8df3\u51fa\u6b7b\u5faa\u73af\u7684\u3002","title":"\u5173\u95ed\u6269\u5c55\u7684\u534f\u7a0bCPU\u5bc6\u96c6\u578b\u8c03\u5ea6"},{"location":"coroutine/coroutine/exists/","text":"Coroutine::exists \u5224\u65ad\u6307\u5b9a\u534f\u7a0b\u662f\u5426\u5b58\u5728\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::exists <?php public static function exists ( $cid ) { } @ param long $cid @ return bool \u53c2\u6570 long $cid \u534f\u7a0b id \u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { $cid = go ( function () { go ( function () { var_dump ( Coroutine :: exists ( Coroutine :: getCid ())); }); }); var_dump ( Coroutine :: exists ( $cid )); }); bool ( true ) bool ( false ) \u56e0\u4e3a\uff0c\u5f53\u6267\u884c\u5230 var_dump(Coroutine::exists($cid)); \u8fd9\u4e00\u884c\u7684\u65f6\u5019\uff0c $cid \u5bf9\u5e94\u7684\u90a3\u4e2a\u534f\u7a0b\u5df2\u7ecf\u6b7b\u4ea1\u4e86\uff0c\u6240\u4ee5\u8fd4\u56de false \u3002","title":"Coroutine::exists"},{"location":"coroutine/coroutine/exists/#coroutineexists","text":"\u5224\u65ad\u6307\u5b9a\u534f\u7a0b\u662f\u5426\u5b58\u5728\u3002","title":"Coroutine::exists"},{"location":"coroutine/coroutine/exists/#_1","text":"Swoole\\Coroutine::exists <?php public static function exists ( $cid ) { } @ param long $cid @ return bool","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/exists/#_2","text":"","title":"\u53c2\u6570"},{"location":"coroutine/coroutine/exists/#long-cid","text":"\u534f\u7a0b id \u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { $cid = go ( function () { go ( function () { var_dump ( Coroutine :: exists ( Coroutine :: getCid ())); }); }); var_dump ( Coroutine :: exists ( $cid )); }); bool ( true ) bool ( false ) \u56e0\u4e3a\uff0c\u5f53\u6267\u884c\u5230 var_dump(Coroutine::exists($cid)); \u8fd9\u4e00\u884c\u7684\u65f6\u5019\uff0c $cid \u5bf9\u5e94\u7684\u90a3\u4e2a\u534f\u7a0b\u5df2\u7ecf\u6b7b\u4ea1\u4e86\uff0c\u6240\u4ee5\u8fd4\u56de false \u3002","title":"long $cid"},{"location":"coroutine/coroutine/getBackTrace/","text":"Coroutine::getBackTrace \u83b7\u53d6\u534f\u7a0b\u51fd\u6570\u8c03\u7528\u6808\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::getBackTrace <?php public static function getBackTrace ( $cid = 0 , $options = DEBUG_BACKTRACE_PROVIDE_OBJECT , $limit = 0 ) { } @ param long | null $cid @ param long | null $options @ param long | null $limit @ return array | false \u53c2\u6570 cid cid\u4e0d\u4e3anull \u83b7\u53d6 cid \u8fd9\u4e2a\u534f\u7a0b\u7684\u51fd\u6570\u8c03\u7528\u6808\u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { $cid = go ( function () { Coroutine :: yield (); }); var_dump ( Coroutine :: getBackTrace ( $cid )); Coroutine :: resume ( $cid ); }); array ( 1 ) { [ 0 ]= > array ( 6 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 9 ) [ \"function\" ]= > string ( 5 ) \"yield\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" [ \"args\" ]= > array ( 0 ) { } } } \u53ef\u4ee5\u770b\u5230 $cid \u8fd9\u4e2a\u534f\u7a0b\u7684\u51fd\u6570\u8c03\u7528\u6808\u4fe1\u606f\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c $cid \u8fd9\u4e2a\u534f\u7a0b\u5f53\u524d\u6267\u884c\u7684\u51fd\u6570\u662f yield \u3002 cid\u4e3anull \u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684\u51fd\u6570\u8c03\u7528\u6808\u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( Coroutine :: getBackTrace ()); }); }); array ( 1 ) { [ 0 ]= > array ( 6 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 9 ) [ \"function\" ]= > string ( 12 ) \"getBackTrace\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" [ \"args\" ]= > array ( 0 ) { } } } \u53ef\u4ee5\u53d1\u73b0\uff0c\u5f53\u524d\u534f\u7a0b\u6267\u884c\u7684\u51fd\u6570\u662f getBackTrace \u3002 options options\u53ef\u4ee5\u53d6\u503c DEBUG_BACKTRACE_PROVIDE_OBJECT \u548c DEBUG_BACKTRACE_IGNORE_ARGS \u3002 options\u4e0d\u4e3anull DEBUG_BACKTRACE_PROVIDE_OBJECT \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( Coroutine :: getBackTrace ( Coroutine :: getCid (), DEBUG_BACKTRACE_PROVIDE_OBJECT )); }); }); array ( 1 ) { [ 0 ]= > array ( 6 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 9 ) [ \"function\" ]= > string ( 12 ) \"getBackTrace\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" [ \"args\" ]= > array ( 2 ) { [ 0 ]= > int ( 2 ) [ 1 ]= > int ( 1 ) } } } \u53ef\u4ee5\u5f97\u5230\u4f20\u9012\u7ed9 getBackTrace \u51fd\u6570\u7684\u53c2\u6570\u3002 DEBUG_BACKTRACE_IGNORE_ARGS \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( Coroutine :: getBackTrace ( Coroutine :: getCid (), DEBUG_BACKTRACE_IGNORE_ARGS )); }); }); array ( 1 ) { [ 0 ]= > array ( 5 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 9 ) [ \"function\" ]= > string ( 12 ) \"getBackTrace\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" } } \u4f1a\u7701\u7565\u4f20\u9012\u7ed9 getBackTrace \u7684\u53c2\u6570\u3002 options\u4e3anull \u5b9e\u9645\u4e0a\u5c31\u662f DEBUG_BACKTRACE_PROVIDE_OBJECT \u3002\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( Coroutine :: getBackTrace ( Coroutine :: getCid ())); }); }); array ( 1 ) { [ 0 ]= > array ( 6 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 9 ) [ \"function\" ]= > string ( 12 ) \"getBackTrace\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" [ \"args\" ]= > array ( 1 ) { [ 0 ]= > int ( 2 ) } } } \u53ef\u4ee5\u5f97\u5230\u4f20\u9012\u7ed9 getBackTrace \u7684\u53c2\u6570\u3002 limit \u6b64\u53c2\u6570\u53ef\u7528\u4e8e\u9650\u5236\u8fd4\u56de\u7684\u51fd\u6570\u8c03\u7528\u6808\u6570\u76ee\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b( limit=0 )\u8fd4\u56de\u6240\u6709\u51fd\u6570\u8c03\u7528\u6808\u3002 limit\u4e0d\u4e3anull \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; function task1 () { task2 (); } function task2 () { task3 (); } function task3 () { var_dump ( Coroutine :: getBackTrace ( Coroutine :: getCid (), DEBUG_BACKTRACE_IGNORE_ARGS , 2 )); } run ( function () { go ( function () { task1 (); }); }); array ( 2 ) { [ 0 ]= > array ( 5 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 19 ) [ \"function\" ]= > string ( 12 ) \"getBackTrace\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" } [ 1 ]= > array ( 3 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 14 ) [ \"function\" ]= > string ( 5 ) \"task3\" } } \u8fd4\u56de\u4e86\u4e24\u5c42\u51fd\u6570\u8c03\u7528\u6808\u3002 limit\u4e3anull \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; function task1 () { task2 (); } function task2 () { task3 (); } function task3 () { var_dump ( Coroutine :: getBackTrace ( Coroutine :: getCid (), DEBUG_BACKTRACE_IGNORE_ARGS )); } run ( function () { go ( function () { task1 (); }); }); array ( 4 ) { [ 0 ]= > array ( 5 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 19 ) [ \"function\" ]= > string ( 12 ) \"getBackTrace\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" } [ 1 ]= > array ( 3 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 14 ) [ \"function\" ]= > string ( 5 ) \"task3\" } [ 2 ]= > array ( 3 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 9 ) [ \"function\" ]= > string ( 5 ) \"task2\" } [ 3 ]= > array ( 3 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 24 ) [ \"function\" ]= > string ( 5 ) \"task1\" } } \u8fd4\u56de\u4e86\u6240\u6709\u7684\u51fd\u6570\u8c03\u7528\u6808\u3002","title":"Coroutine::getBackTrace"},{"location":"coroutine/coroutine/getBackTrace/#coroutinegetbacktrace","text":"\u83b7\u53d6\u534f\u7a0b\u51fd\u6570\u8c03\u7528\u6808\u3002","title":"Coroutine::getBackTrace"},{"location":"coroutine/coroutine/getBackTrace/#_1","text":"Swoole\\Coroutine::getBackTrace <?php public static function getBackTrace ( $cid = 0 , $options = DEBUG_BACKTRACE_PROVIDE_OBJECT , $limit = 0 ) { } @ param long | null $cid @ param long | null $options @ param long | null $limit @ return array | false","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/getBackTrace/#_2","text":"","title":"\u53c2\u6570"},{"location":"coroutine/coroutine/getBackTrace/#cid","text":"","title":"cid"},{"location":"coroutine/coroutine/getBackTrace/#cidnull","text":"\u83b7\u53d6 cid \u8fd9\u4e2a\u534f\u7a0b\u7684\u51fd\u6570\u8c03\u7528\u6808\u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { $cid = go ( function () { Coroutine :: yield (); }); var_dump ( Coroutine :: getBackTrace ( $cid )); Coroutine :: resume ( $cid ); }); array ( 1 ) { [ 0 ]= > array ( 6 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 9 ) [ \"function\" ]= > string ( 5 ) \"yield\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" [ \"args\" ]= > array ( 0 ) { } } } \u53ef\u4ee5\u770b\u5230 $cid \u8fd9\u4e2a\u534f\u7a0b\u7684\u51fd\u6570\u8c03\u7528\u6808\u4fe1\u606f\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c $cid \u8fd9\u4e2a\u534f\u7a0b\u5f53\u524d\u6267\u884c\u7684\u51fd\u6570\u662f yield \u3002","title":"cid\u4e0d\u4e3anull"},{"location":"coroutine/coroutine/getBackTrace/#cidnull_1","text":"\u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684\u51fd\u6570\u8c03\u7528\u6808\u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( Coroutine :: getBackTrace ()); }); }); array ( 1 ) { [ 0 ]= > array ( 6 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 9 ) [ \"function\" ]= > string ( 12 ) \"getBackTrace\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" [ \"args\" ]= > array ( 0 ) { } } } \u53ef\u4ee5\u53d1\u73b0\uff0c\u5f53\u524d\u534f\u7a0b\u6267\u884c\u7684\u51fd\u6570\u662f getBackTrace \u3002","title":"cid\u4e3anull"},{"location":"coroutine/coroutine/getBackTrace/#options","text":"options\u53ef\u4ee5\u53d6\u503c DEBUG_BACKTRACE_PROVIDE_OBJECT \u548c DEBUG_BACKTRACE_IGNORE_ARGS \u3002","title":"options"},{"location":"coroutine/coroutine/getBackTrace/#optionsnull","text":"","title":"options\u4e0d\u4e3anull"},{"location":"coroutine/coroutine/getBackTrace/#debug_backtrace_provide_object","text":"\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( Coroutine :: getBackTrace ( Coroutine :: getCid (), DEBUG_BACKTRACE_PROVIDE_OBJECT )); }); }); array ( 1 ) { [ 0 ]= > array ( 6 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 9 ) [ \"function\" ]= > string ( 12 ) \"getBackTrace\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" [ \"args\" ]= > array ( 2 ) { [ 0 ]= > int ( 2 ) [ 1 ]= > int ( 1 ) } } } \u53ef\u4ee5\u5f97\u5230\u4f20\u9012\u7ed9 getBackTrace \u51fd\u6570\u7684\u53c2\u6570\u3002","title":"DEBUG_BACKTRACE_PROVIDE_OBJECT"},{"location":"coroutine/coroutine/getBackTrace/#debug_backtrace_ignore_args","text":"\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( Coroutine :: getBackTrace ( Coroutine :: getCid (), DEBUG_BACKTRACE_IGNORE_ARGS )); }); }); array ( 1 ) { [ 0 ]= > array ( 5 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 9 ) [ \"function\" ]= > string ( 12 ) \"getBackTrace\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" } } \u4f1a\u7701\u7565\u4f20\u9012\u7ed9 getBackTrace \u7684\u53c2\u6570\u3002","title":"DEBUG_BACKTRACE_IGNORE_ARGS"},{"location":"coroutine/coroutine/getBackTrace/#optionsnull_1","text":"\u5b9e\u9645\u4e0a\u5c31\u662f DEBUG_BACKTRACE_PROVIDE_OBJECT \u3002\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( Coroutine :: getBackTrace ( Coroutine :: getCid ())); }); }); array ( 1 ) { [ 0 ]= > array ( 6 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 9 ) [ \"function\" ]= > string ( 12 ) \"getBackTrace\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" [ \"args\" ]= > array ( 1 ) { [ 0 ]= > int ( 2 ) } } } \u53ef\u4ee5\u5f97\u5230\u4f20\u9012\u7ed9 getBackTrace \u7684\u53c2\u6570\u3002","title":"options\u4e3anull"},{"location":"coroutine/coroutine/getBackTrace/#limit","text":"\u6b64\u53c2\u6570\u53ef\u7528\u4e8e\u9650\u5236\u8fd4\u56de\u7684\u51fd\u6570\u8c03\u7528\u6808\u6570\u76ee\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b( limit=0 )\u8fd4\u56de\u6240\u6709\u51fd\u6570\u8c03\u7528\u6808\u3002","title":"limit"},{"location":"coroutine/coroutine/getBackTrace/#limitnull","text":"\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; function task1 () { task2 (); } function task2 () { task3 (); } function task3 () { var_dump ( Coroutine :: getBackTrace ( Coroutine :: getCid (), DEBUG_BACKTRACE_IGNORE_ARGS , 2 )); } run ( function () { go ( function () { task1 (); }); }); array ( 2 ) { [ 0 ]= > array ( 5 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 19 ) [ \"function\" ]= > string ( 12 ) \"getBackTrace\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" } [ 1 ]= > array ( 3 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 14 ) [ \"function\" ]= > string ( 5 ) \"task3\" } } \u8fd4\u56de\u4e86\u4e24\u5c42\u51fd\u6570\u8c03\u7528\u6808\u3002","title":"limit\u4e0d\u4e3anull"},{"location":"coroutine/coroutine/getBackTrace/#limitnull_1","text":"\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; function task1 () { task2 (); } function task2 () { task3 (); } function task3 () { var_dump ( Coroutine :: getBackTrace ( Coroutine :: getCid (), DEBUG_BACKTRACE_IGNORE_ARGS )); } run ( function () { go ( function () { task1 (); }); }); array ( 4 ) { [ 0 ]= > array ( 5 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 19 ) [ \"function\" ]= > string ( 12 ) \"getBackTrace\" [ \"class\" ]= > string ( 16 ) \"Swoole\\Coroutine\" [ \"type\" ]= > string ( 2 ) \"::\" } [ 1 ]= > array ( 3 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 14 ) [ \"function\" ]= > string ( 5 ) \"task3\" } [ 2 ]= > array ( 3 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 9 ) [ \"function\" ]= > string ( 5 ) \"task2\" } [ 3 ]= > array ( 3 ) { [ \"file\" ]= > string ( 78 ) \"/Users/codinghuang/codeDir/phpCode/swoole/coroutine/coroutine/getBackTrace.php\" [ \"line\" ]= > int ( 24 ) [ \"function\" ]= > string ( 5 ) \"task1\" } } \u8fd4\u56de\u4e86\u6240\u6709\u7684\u51fd\u6570\u8c03\u7528\u6808\u3002","title":"limit\u4e3anull"},{"location":"coroutine/coroutine/getCid/","text":"Coroutine::getCid \u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684\u552f\u4e00 ID , \u5b83\u7684\u522b\u540d\u4e3a getUid , \u662f\u4e00\u4e2a\u8fdb\u7a0b\u5185\u552f\u4e00\u7684\u6b63\u6574\u6570\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::getCid <?php public static function getCid () { } @ return mixed \u65e0\u53c2\u6570 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { var_dump ( Coroutine :: getCid ()); }); int ( 1 )","title":"Coroutine::getCid"},{"location":"coroutine/coroutine/getCid/#coroutinegetcid","text":"\u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684\u552f\u4e00 ID , \u5b83\u7684\u522b\u540d\u4e3a getUid , \u662f\u4e00\u4e2a\u8fdb\u7a0b\u5185\u552f\u4e00\u7684\u6b63\u6574\u6570\u3002","title":"Coroutine::getCid"},{"location":"coroutine/coroutine/getCid/#_1","text":"Swoole\\Coroutine::getCid <?php public static function getCid () { } @ return mixed","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/getCid/#_2","text":"\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { var_dump ( Coroutine :: getCid ()); }); int ( 1 )","title":"\u65e0\u53c2\u6570"},{"location":"coroutine/coroutine/getContext/","text":"Coroutine::getContext \u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684\u4e0a\u4e0b\u6587\u5bf9\u8c61\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::getContext <?php public static function getContext ( $cid = null ) { } @ param long | null $cid @ return long \u53c2\u6570 long|null $cid \u67d0\u4e2a\u534f\u7a0b\u7684 cid \u6216\u8005 null \u3002 \u5982\u679c\u4e3a null \uff0c\u4ee3\u8868\u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684 pcid \u3002 <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; function func ( callable $fn , ... $args ) { go ( function () use ( $fn , $args ) { $fn ( ... $args ); echo 'Coroutine#' . Coroutine :: getCid () . ' exit' . PHP_EOL ; }); } /** * Compatibility for lower version * @param object|Resource $object * @return int */ function php_object_id ( $object ) { static $id = 0 ; static $map = []; $hash = spl_object_hash ( $object ); return $map [ $hash ] ?? ( $map [ $hash ] = ++ $id ); } class Resource { public function __construct () { echo __CLASS__ . '#' . php_object_id (( object ) $this ) . ' constructed' . PHP_EOL ; } public function __destruct () { echo __CLASS__ . '#' . php_object_id (( object ) $this ) . ' destructed' . PHP_EOL ; } } run ( function () { $context = new Coroutine\\Context (); assert ( $context instanceof ArrayObject ); assert ( Coroutine :: getContext () === null ); func ( function () { $context = Coroutine :: getContext (); assert ( $context instanceof Co\\Context ); $context [ 'resource1' ] = new Resource ; $context -> resource2 = new Resource ; func ( function () { Coroutine :: getContext ()[ 'resource3' ] = new Resource ; Coroutine :: yield (); Coroutine :: getContext ()[ 'resource3' ] -> resource4 = new Resource ; Coroutine :: getContext () -> resource5 = new Resource ; }); }); Coroutine :: resume ( 3 ); }); Resource#1 constructed Resource#2 constructed Resource#3 constructed Coroutine#2 exit Resource#2 destructed Resource#1 destructed Resource#4 constructed Resource#5 constructed Coroutine#3 exit Resource#5 destructed Resource#3 destructed Resource#4 destructed","title":"Coroutine::getContext"},{"location":"coroutine/coroutine/getContext/#coroutinegetcontext","text":"\u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684\u4e0a\u4e0b\u6587\u5bf9\u8c61\u3002","title":"Coroutine::getContext"},{"location":"coroutine/coroutine/getContext/#_1","text":"Swoole\\Coroutine::getContext <?php public static function getContext ( $cid = null ) { } @ param long | null $cid @ return long","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/getContext/#_2","text":"","title":"\u53c2\u6570"},{"location":"coroutine/coroutine/getContext/#longnull-cid","text":"\u67d0\u4e2a\u534f\u7a0b\u7684 cid \u6216\u8005 null \u3002 \u5982\u679c\u4e3a null \uff0c\u4ee3\u8868\u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684 pcid \u3002 <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; function func ( callable $fn , ... $args ) { go ( function () use ( $fn , $args ) { $fn ( ... $args ); echo 'Coroutine#' . Coroutine :: getCid () . ' exit' . PHP_EOL ; }); } /** * Compatibility for lower version * @param object|Resource $object * @return int */ function php_object_id ( $object ) { static $id = 0 ; static $map = []; $hash = spl_object_hash ( $object ); return $map [ $hash ] ?? ( $map [ $hash ] = ++ $id ); } class Resource { public function __construct () { echo __CLASS__ . '#' . php_object_id (( object ) $this ) . ' constructed' . PHP_EOL ; } public function __destruct () { echo __CLASS__ . '#' . php_object_id (( object ) $this ) . ' destructed' . PHP_EOL ; } } run ( function () { $context = new Coroutine\\Context (); assert ( $context instanceof ArrayObject ); assert ( Coroutine :: getContext () === null ); func ( function () { $context = Coroutine :: getContext (); assert ( $context instanceof Co\\Context ); $context [ 'resource1' ] = new Resource ; $context -> resource2 = new Resource ; func ( function () { Coroutine :: getContext ()[ 'resource3' ] = new Resource ; Coroutine :: yield (); Coroutine :: getContext ()[ 'resource3' ] -> resource4 = new Resource ; Coroutine :: getContext () -> resource5 = new Resource ; }); }); Coroutine :: resume ( 3 ); }); Resource#1 constructed Resource#2 constructed Resource#3 constructed Coroutine#2 exit Resource#2 destructed Resource#1 destructed Resource#4 constructed Resource#5 constructed Coroutine#3 exit Resource#5 destructed Resource#3 destructed Resource#4 destructed","title":"long|null $cid"},{"location":"coroutine/coroutine/getPcid/","text":"Coroutine::getPcid \u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684\u7236 cid \u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::getPcid <?php public static function getPcid ( $cid = null ) { } @ param long | null $cid @ return long \u53c2\u6570 long|null $cid \u67d0\u4e2a\u534f\u7a0b\u7684 cid \u6216\u8005 null \u3002 \u5982\u679c\u4e3a null \uff0c\u4ee3\u8868\u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684 pcid \u3002 cid\u4e0d\u4e3anull <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( Coroutine :: getPcid ( 2 )); }); }); int ( 1 ) cid\u4e3anull <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( Coroutine :: getPcid ()); }); }); int ( 1 ) \u6ce8\u610f \u534f\u7a0b\u4e4b\u95f4\u5e76\u6ca1\u6709\u5b9e\u8d28\u4e0a\u7684\u7236\u5b50\u5173\u7cfb\uff0c\u534f\u7a0b\u4e4b\u95f4\u662f\u76f8\u4e92\u9694\u79bb\u3001\u72ec\u7acb\u8fd0\u4f5c\u7684\u3002\u6b64 Pcid \u53ef\u7406\u89e3\u4e3a\u662f\u54ea\u4e2a\u534f\u7a0b\u521b\u5efa\u4e86\u5f53\u524d\u534f\u7a0b\u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( \"parent coroutine start\" ); Coroutine :: defer ( function () { var_dump ( \"parent coroutine dead\" ); }); go ( function () { var_dump ( \"child coroutine start\" ); Coroutine :: sleep ( 0.01 ); var_dump ( \"child coroutine still running\" ); }); }); }); string ( 22 ) \"parent coroutine start\" string ( 21 ) \"child coroutine start\" string ( 21 ) \"parent coroutine dead\" string ( 29 ) \"child coroutine still running\" \u7236\u534f\u7a0b\u6b7b\u4ea1\u4e4b\u540e\uff0c\u5b50\u534f\u7a0b\u4f9d\u7136\u8fd8\u5728\u8fd0\u884c\u3002","title":"Coroutine::getPcid"},{"location":"coroutine/coroutine/getPcid/#coroutinegetpcid","text":"\u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684\u7236 cid \u3002","title":"Coroutine::getPcid"},{"location":"coroutine/coroutine/getPcid/#_1","text":"Swoole\\Coroutine::getPcid <?php public static function getPcid ( $cid = null ) { } @ param long | null $cid @ return long","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/getPcid/#_2","text":"","title":"\u53c2\u6570"},{"location":"coroutine/coroutine/getPcid/#longnull-cid","text":"\u67d0\u4e2a\u534f\u7a0b\u7684 cid \u6216\u8005 null \u3002 \u5982\u679c\u4e3a null \uff0c\u4ee3\u8868\u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684 pcid \u3002","title":"long|null $cid"},{"location":"coroutine/coroutine/getPcid/#cidnull","text":"<?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( Coroutine :: getPcid ( 2 )); }); }); int ( 1 )","title":"cid\u4e0d\u4e3anull"},{"location":"coroutine/coroutine/getPcid/#cidnull_1","text":"<?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( Coroutine :: getPcid ()); }); }); int ( 1 )","title":"cid\u4e3anull"},{"location":"coroutine/coroutine/getPcid/#_3","text":"\u534f\u7a0b\u4e4b\u95f4\u5e76\u6ca1\u6709\u5b9e\u8d28\u4e0a\u7684\u7236\u5b50\u5173\u7cfb\uff0c\u534f\u7a0b\u4e4b\u95f4\u662f\u76f8\u4e92\u9694\u79bb\u3001\u72ec\u7acb\u8fd0\u4f5c\u7684\u3002\u6b64 Pcid \u53ef\u7406\u89e3\u4e3a\u662f\u54ea\u4e2a\u534f\u7a0b\u521b\u5efa\u4e86\u5f53\u524d\u534f\u7a0b\u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { var_dump ( \"parent coroutine start\" ); Coroutine :: defer ( function () { var_dump ( \"parent coroutine dead\" ); }); go ( function () { var_dump ( \"child coroutine start\" ); Coroutine :: sleep ( 0.01 ); var_dump ( \"child coroutine still running\" ); }); }); }); string ( 22 ) \"parent coroutine start\" string ( 21 ) \"child coroutine start\" string ( 21 ) \"parent coroutine dead\" string ( 29 ) \"child coroutine still running\" \u7236\u534f\u7a0b\u6b7b\u4ea1\u4e4b\u540e\uff0c\u5b50\u534f\u7a0b\u4f9d\u7136\u8fd8\u5728\u8fd0\u884c\u3002","title":"\u6ce8\u610f"},{"location":"coroutine/coroutine/list/","text":"Coroutine::list \u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u53ef\u4ee5\u7528\u6765\u904d\u5386\u6240\u6709 \u5b58\u6d3b \u7684\u534f\u7a0b\u3002\u5bf9\u8fd4\u56de\u7684\u5bf9\u8c61\u8fdb\u884c\u8fed\u4ee3\uff0c\u53ef\u4ee5\u5f97\u5230\u6240\u6709\u534f\u7a0b\u7684 cid \u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::list <?php public static function list () { } @ return Swoole\\Coroutine\\Iterator \u65e0\u53c2\u6570 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { go ( function () { go ( function () { go ( function () { $coros = Coroutine :: list (); var_dump ( $coros ); foreach ( $coros as $co ) { var_dump ( $co ); } }); }); }); }); }); object ( Swoole \\C oroutine \\I terator ) #7 (1) { [ \"storage\" : \"ArrayIterator\" :private ]= > array ( 5 ) { [ 0 ]= > int ( 5 ) [ 1 ]= > int ( 4 ) [ 2 ]= > int ( 3 ) [ 3 ]= > int ( 2 ) [ 4 ]= > int ( 1 ) } } int ( 5 ) int ( 4 ) int ( 3 ) int ( 2 ) int ( 1 )","title":"Coroutine::list"},{"location":"coroutine/coroutine/list/#coroutinelist","text":"\u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u53ef\u4ee5\u7528\u6765\u904d\u5386\u6240\u6709 \u5b58\u6d3b \u7684\u534f\u7a0b\u3002\u5bf9\u8fd4\u56de\u7684\u5bf9\u8c61\u8fdb\u884c\u8fed\u4ee3\uff0c\u53ef\u4ee5\u5f97\u5230\u6240\u6709\u534f\u7a0b\u7684 cid \u3002","title":"Coroutine::list"},{"location":"coroutine/coroutine/list/#_1","text":"Swoole\\Coroutine::list <?php public static function list () { } @ return Swoole\\Coroutine\\Iterator","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/list/#_2","text":"\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { go ( function () { go ( function () { go ( function () { $coros = Coroutine :: list (); var_dump ( $coros ); foreach ( $coros as $co ) { var_dump ( $co ); } }); }); }); }); }); object ( Swoole \\C oroutine \\I terator ) #7 (1) { [ \"storage\" : \"ArrayIterator\" :private ]= > array ( 5 ) { [ 0 ]= > int ( 5 ) [ 1 ]= > int ( 4 ) [ 2 ]= > int ( 3 ) [ 3 ]= > int ( 2 ) [ 4 ]= > int ( 1 ) } } int ( 5 ) int ( 4 ) int ( 3 ) int ( 2 ) int ( 1 )","title":"\u65e0\u53c2\u6570"},{"location":"coroutine/coroutine/resume/","text":"Coroutine::resume \u8ba9\u6307\u5b9a\u7684\u534f\u7a0b\u7ee7\u7eed\u8fd0\u884c\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::resume <?php public static function resume ( $cid ) { } @ param long $cid @ return bool \u53c2\u6570 long $cid \u9700\u8981\u7ee7\u7eed\u8fd0\u884c\u7684\u534f\u7a0b cid \u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { $cid = go ( function () { var_dump ( Coroutine :: getCid ()); Coroutine :: yield (); var_dump ( Coroutine :: getCid ()); }); go ( function () use ( $cid ) { var_dump ( Coroutine :: getCid ()); Coroutine :: resume ( $cid ); var_dump ( Coroutine :: getCid ()); }); }); int ( 2 ) int ( 3 ) int ( 2 ) int ( 3 )","title":"Coroutine::resume"},{"location":"coroutine/coroutine/resume/#coroutineresume","text":"\u8ba9\u6307\u5b9a\u7684\u534f\u7a0b\u7ee7\u7eed\u8fd0\u884c\u3002","title":"Coroutine::resume"},{"location":"coroutine/coroutine/resume/#_1","text":"Swoole\\Coroutine::resume <?php public static function resume ( $cid ) { } @ param long $cid @ return bool","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/resume/#_2","text":"","title":"\u53c2\u6570"},{"location":"coroutine/coroutine/resume/#long-cid","text":"\u9700\u8981\u7ee7\u7eed\u8fd0\u884c\u7684\u534f\u7a0b cid \u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { $cid = go ( function () { var_dump ( Coroutine :: getCid ()); Coroutine :: yield (); var_dump ( Coroutine :: getCid ()); }); go ( function () use ( $cid ) { var_dump ( Coroutine :: getCid ()); Coroutine :: resume ( $cid ); var_dump ( Coroutine :: getCid ()); }); }); int ( 2 ) int ( 3 ) int ( 2 ) int ( 3 )","title":"long $cid"},{"location":"coroutine/coroutine/set/","text":"Coroutine::set Coroutine::set \u7528\u6765\u8bbe\u7f6e\u534f\u7a0b\u76f8\u5173\u9009\u9879\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::set <?php public static function set ( $options ) { } @ param array $options @ return mixed \u53c2\u6570 array $options \u76f8\u5173\u7684\u914d\u7f6e\u9879\u3002 max_coroutine \u8bbe\u7f6e\u6700\u5927\u534f\u7a0b\u6570\uff0c\u8d85\u8fc7\u9650\u5236\u540e\u5e95\u5c42\u5c06\u65e0\u6cd5\u521b\u5efa\u65b0\u7684\u534f\u7a0b\u3002 \u6ce8\u610f\uff0c\u8fd9\u4e2a\u6700\u5927\u534f\u7a0b\u6570\u6307\u7684\u662f\u8fd9\u4e2a\u7ebf\u7a0b\u76ee\u524d\u5b58\u6d3b\u7684\u534f\u7a0b\u6570\uff0c\u800c\u4e0d\u662f\u521b\u5efa\u7684\u534f\u7a0b\u4e2a\u6570\u3002\u56e0\u4e3a\u6b7b\u4ea1\u7684\u534f\u7a0b\u662f\u4e0d\u8bb0\u5f55\u5728\u534f\u7a0b\u4e2a\u6570\u91cc\u9762\u7684\u3002 \u4f8b\u5b50\uff1a <?php Swoole\\Coroutine :: set ([ 'max_coroutine' => 5 , ]); for ( $i = 0 ; $i < 6 ; $i ++ ) { go ( function () { echo 'swoole' . PHP_EOL ; }); } swoole swoole swoole swoole swoole swoole \u4f9d\u7136\u53ef\u4ee5\u521b\u5efa\u51fa 6 \u4e2a\u534f\u7a0b\u3002\u56e0\u4e3a\u534f\u7a0b\u521b\u5efa\u5b8c\u4e4b\u540e\uff0c\u6267\u884c echo \u5c31\u4f1a\u7acb\u9a6c\u6b7b\u4ea1\uff0c\u63a5\u7740\u521b\u5efa\u4e0b\u4e00\u4e2a\u534f\u7a0b\u3002 \u4f46\u662f\uff0c\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u662f\u4f1a\u5931\u8d25\u7684\uff1a <?php Swoole\\Coroutine :: set ([ 'max_coroutine' => 5 , ]); go ( function () { echo 'swoole' . PHP_EOL ; go ( function () { echo 'swoole' . PHP_EOL ; go ( function () { echo 'swoole' . PHP_EOL ; go ( function () { echo 'swoole' . PHP_EOL ; go ( function () { echo 'swoole' . PHP_EOL ; go ( function () { echo 'swoole' . PHP_EOL ; }); }); }); }); }); }); php set.php swoole swoole swoole swoole swoole PHP Warning: go () : exceed max number of coroutine 5 in /root/codeDir/phpCode/swoole/coroutine/coroutine/set.php on line 19 hook_flags \u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u5c06\u57fa\u4e8e php_stream \u5b9e\u73b0\u7684\u6269\u5c55\u3001 PHP \u7f51\u7edc\u5ba2\u6237\u7aef\u4ee3\u7801\u4e00\u952e\u534f\u7a0b\u5316\u3002 Swoole \u521b\u5efa\u534f\u7a0b\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u662f\u4e0d\u4f1a hook \u7684\u3002 \u53ef\u4ee5 hook \u7684 flag \u6709\uff1a SWOOLE_HOOK_TCP \u4f8b\u5b50\uff1a hook \u7684 tcp \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_TCP , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $ctx = stream_context_create ([ 'socket' => [ 'so_reuseaddr' => true , 'backlog' => 128 ]]); $socket = stream_socket_server ( 'tcp://0.0.0.0:6666' , $errno , $errstr , STREAM_SERVER_BIND | STREAM_SERVER_LISTEN , $ctx ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_accept ( $socket )) { } }); echo \"here\" . PHP_EOL ; }); here \u6ca1\u6709 hook \u7684 tcp \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $ctx = stream_context_create ([ 'socket' => [ 'so_reuseaddr' => true , 'backlog' => 128 ]]); $socket = stream_socket_server ( 'tcp://0.0.0.0:6666' , $errno , $errstr , STREAM_SERVER_BIND | STREAM_SERVER_LISTEN , $ctx ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_accept ( $socket )) { } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\u3002 SWOOLE_HOOK_UDP hook \u7684 udp \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_UDP , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $socket = stream_socket_server ( 'udp://0.0.0.0:6666' , $errno , $errstr , STREAM_SERVER_BIND ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_recvfrom ( $socket , 1 , 0 )) { } }); echo \"here\" . PHP_EOL ; }); here \u6ca1\u6709 hook \u7684 udp \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $socket = stream_socket_server ( 'udp://0.0.0.0:6666' , $errno , $errstr , STREAM_SERVER_BIND ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_recvfrom ( $socket , 1 , 0 )) { } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\u3002 SWOOLE_HOOK_UNIX hook \u7684 unix \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_UNIX , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $socket = stream_socket_server ( 'unix://swoole.sock' , $errno , $errstr , STREAM_SERVER_BIND | STREAM_SERVER_LISTEN ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_accept ( $socket )) { } }); echo \"here\" . PHP_EOL ; }); here \u6ca1\u6709 hook \u7684 unix \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $socket = stream_socket_server ( 'unix://swoole.sock' , $errno , $errstr , STREAM_SERVER_BIND | STREAM_SERVER_LISTEN ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_accept ( $socket )) { } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\u3002 SWOOLE_HOOK_UDG hook \u7684 udg \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_UDG , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $socket = stream_socket_server ( 'udg://swoole.sock' , $errno , $errstr , STREAM_SERVER_BIND ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_recvfrom ( $socket , 1 , 0 )) { } }); echo \"here\" . PHP_EOL ; }); here \u6ca1\u6709 hook \u7684 udg \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $socket = stream_socket_server ( 'udg://swoole.sock' , $errno , $errstr , STREAM_SERVER_BIND ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_recvfrom ( $socket , 1 , 0 )) { } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\u3002 SWOOLE_HOOK_SSL TODO SWOOLE_HOOK_TLS TODO SWOOLE_HOOK_STREAM_FUNCTION TODO SWOOLE_HOOK_FILE hook \u7684 file \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_FILE , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $fp = fopen ( __FILE__ , 'r' ); while ( true ) { fread ( $fp , 1024 ); } }); echo \"here\" . PHP_EOL ; }); here \u6ca1\u6709 hook \u7684 file \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $fp = fopen ( __FILE__ , 'r' ); while ( true ) { fread ( $fp , 1024 ); } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\u3002 SWOOLE_HOOK_SLEEP \u4f8b\u5b50\uff1a hook \u7684 sleep \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_SLEEP , ]); Swoole\\Coroutine\\run ( function () { go ( function () { sleep ( 1 ); echo '1' . PHP_EOL ; }); go ( function () { echo '2' . PHP_EOL ; }); }); 2 1 \u6ca1\u6709 hook \u7684 sleep \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { sleep ( 1 ); echo '1' . PHP_EOL ; }); go ( function () { echo '2' . PHP_EOL ; }); }); 1 2 SWOOLE_HOOK_PROC hook \u7684 proc \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_PROC , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $descriptorspec = array ( 0 => array ( \"pipe\" , \"r\" ), // stdin, child process read from it 1 => array ( \"pipe\" , \"w\" ), // stdout, child process write to it ); $process = proc_open ( 'php' , $descriptorspec , $pipes ); if ( is_resource ( $process )) { fwrite ( $pipes [ 0 ], '<?php echo \"I am process\\n\" ?>' ); fclose ( $pipes [ 0 ]); while ( true ) { echo fread ( $pipes [ 1 ], 1024 ); } fclose ( $pipes [ 1 ]); $return_value = proc_close ( $process ); echo \"command returned $return_value \" . PHP_EOL ; } }); echo \"here\" . PHP_EOL ; }); \u6253\u5370\u51fa here \u5b57\u7b26\u4e32\uff1a here I am process \u6ca1\u6709 hook \u7684 proc \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $descriptorspec = array ( 0 => array ( \"pipe\" , \"r\" ), // stdin, child process read from it 1 => array ( \"pipe\" , \"w\" ), // stdout, child process write to it ); $process = proc_open ( 'php' , $descriptorspec , $pipes ); if ( is_resource ( $process )) { fwrite ( $pipes [ 0 ], '<?php echo \"I am process\\n\" ?>' ); fclose ( $pipes [ 0 ]); while ( true ) { echo fread ( $pipes [ 1 ], 1024 ); } fclose ( $pipes [ 1 ]); $return_value = proc_close ( $process ); echo \"command returned $return_value \" . PHP_EOL ; } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\uff1a I am process SWOOLE_HOOK_BLOCKING_FUNCTION \u8fd9\u91cc\u7684 blocking function \u5305\u62ec\u4e86\uff1a gethostbyname \u3001 exec \u3001 shell_exec \u3002 hook \u7684 blocking function \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_BLOCKING_FUNCTION , ]); Swoole\\Coroutine\\run ( function () { go ( function () { while ( true ) { exec ( \"cat\" ); } }); echo \"here\" . PHP_EOL ; }); here \u6ca1\u6709 hook \u7684 blocking function \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { while ( true ) { exec ( \"cat\" ); } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\u3002 SWOOLE_HOOK_CURL TODO c_stack_size \u8bbe\u7f6e\u5355\u4e2a\u534f\u7a0b\u521d\u59cb\u6808\u7684\u5185\u5b58\u5c3a\u5bf8\uff0c\u5355\u4f4d\u662f B \uff0c\u9ed8\u8ba4\u4e3a 2 * 1024 * 1024B \uff0c\u5373 2MB \u3002\u8303\u56f4\uff1a 256 * 1024B \uff5e 16 * 1024 * 1024 \u3002 \u6ce8\u610f\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u7684\u662f\u534f\u7a0b\u521d\u59cbC\u6808\u7684\u5927\u5c0f\uff0c\u800c\u4e0d\u662f\u534f\u7a0b\u521d\u59cbPHP\u6808\u7684\u5927\u5c0f\u3002 \u534f\u7a0b\u521d\u59cbPHP\u6808\u7684\u5927\u5c0f\u76ee\u524d\u662f\u56fa\u5b9a\u76848 * 1024B\u3002 socket_connect_timeout \u5efa\u7acb socket \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4, \u5355\u4f4d\uff1a s \uff0c\u9ed8\u8ba4\u4e3a 1s \u3002\u8bbe\u7f6e\u4e3a -1 \uff0c\u8868\u793a\u6c38\u4e0d\u8d85\u65f6\u3002 \u6ce8\u610f\uff0c\u8fd9\u91cc\u4e0d\u80fd\u8bbe\u7f6e\u4e3a0\u3002\u8bbe\u7f6e\u4e3a0\u7684\u8bdd\uff0c\u4f1a\u53d6\u9ed8\u8ba4\u503c\u3002 socket_timeout \u8bbe\u7f6e socket \u8bfb\u548c\u5199\u7684\u64cd\u4f5c\u8d85\u65f6\u65f6\u95f4, \u5355\u4f4d\uff1a s \uff0c\u9ed8\u8ba4\u4e3a -1 , \u5373\u6c38\u4e0d\u8d85\u65f6\u3002 \u6ce8\u610f\uff0c\u8fd9\u91cc\u4e0d\u80fd\u8bbe\u7f6e\u4e3a0\u3002\u8bbe\u7f6e\u4e3a0\u7684\u8bdd\uff0c\u4f1a\u53d6\u9ed8\u8ba4\u503c\u3002 socket_read_timeout \u53ea\u8bbe\u7f6e socket \u8bfb\u7684\u64cd\u4f5c\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d s \uff0c\u9ed8\u8ba4\u4e3a -1 , \u5373\u6c38\u4e0d\u8d85\u65f6\u3002 \u6ce8\u610f\uff0c\u8fd9\u91cc\u4e0d\u80fd\u8bbe\u7f6e\u4e3a0\u3002\u8bbe\u7f6e\u4e3a0\u7684\u8bdd\uff0c\u4f1a\u53d6\u9ed8\u8ba4\u503c\u3002 socket_write_timeout \u53ea\u8bbe\u7f6e socket \u5199\u7684\u64cd\u4f5c\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d s \uff0c\u9ed8\u8ba4\u4e3a -1 , \u5373\u6c38\u4e0d\u8d85\u65f6\u3002 \u6ce8\u610f\uff0c\u8fd9\u91cc\u4e0d\u80fd\u8bbe\u7f6e\u4e3a0\u3002\u8bbe\u7f6e\u4e3a0\u7684\u8bdd\uff0c\u4f1a\u53d6\u9ed8\u8ba4\u503c\u3002 log_level \u8bbe\u7f6e\u65e5\u5fd7\u7b49\u7ea7\u3002\u5927\u4e8e\u7b49\u4e8e\u8fd9\u4e2a\u65e5\u5fd7\u7b49\u7ea7\u7684\u65e5\u5fd7 \u624d \u4f1a\u88ab\u6253\u5370\u51fa\u6765\u3002 \u6ce8\u610f\uff0c\u8fd9\u91cc\u914d\u7f6e\u7684\u4e0d\u662fPHP\u5c42\u7684\u65e5\u5fd7\u7ea7\u522b\uff0c\u800c\u662fC\u5c42\u7684\u65e5\u5fd7\u7ea7\u522b\uff0c\u540e\u9762\u4f1a\u6709\u4e00\u4e2a\u4f8b\u5b50\u8fdb\u884c\u8bf4\u660e\u3002 \u53ef\u914d\u7f6e\u7684\u65e5\u5fd7\u7b49\u7ea7\u4ece\u4f4e\u5230\u9ad8\u4e3a\uff1a SWOOLE_LOG_DEBUG SWOOLE_LOG_TRACE SWOOLE_LOG_INFO SWOOLE_LOG_NOTICE SWOOLE_LOG_WARNING SWOOLE_LOG_ERROR \u6ce8\u610f\uff0c\u5982\u679c\u5728\u7f16\u8bd1 Swoole \u7684\u65f6\u5019\u5f00\u542f\u4e86 debug \uff0c\u90a3\u4e48 log_level \u9ed8\u8ba4\u662f SWOOLE_LOG_DEBUG \uff1b\u5426\u5219 log_level \u9ed8\u8ba4\u662f SWOOLE_LOG_INFO \u3002 \u6ca1\u6709\u8bbe\u7f6e log_level \u7684\u4f8b\u5b50\uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $client = new Swoole\\Coroutine\\Client ( SWOOLE_TCP ); $client -> connect ( '127.0.0.1' ); }); }); \u6b64\u65f6\u4f1a\u6253\u5370 PHP \u5c42 Warning \u7ea7\u522b\u7684\u8b66\u544a\uff1a PHP Warning: Swoole \\C oroutine \\C lient::connect () : The port is invalid in /root/codeDir/phpCode/swoole/coroutine/coroutine/set.php on line 6 \u8bbe\u7f6e log_level \u7684\u4f8b\u5b50\uff1a <?php Swoole\\Coroutine :: set ([ 'log_level' => SWOOLE_LOG_ERROR , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $client = new Swoole\\Coroutine\\Client ( SWOOLE_TCP ); $client -> connect ( '127.0.0.1' ); }); }); \u6b64\u65f6\u4f9d\u7136\u4f1a\u6253\u5370\u51fa PHP \u5c42 Warning \u7ea7\u522b\u7684\u8b66\u544a\uff1a PHP Warning: Swoole \\C oroutine \\C lient::connect () : The port is invalid in /root/codeDir/phpCode/swoole/coroutine/coroutine/set.php on line 10 trace_flags TODO dns_cache_expire \u8bbe\u7f6e swoole dns \u7f13\u5b58\u5931\u6548\u65f6\u95f4\uff0c\u5355\u4f4d s \uff0c\u9ed8\u8ba4 60s \u3002 dns_cache_capacity \u8bbe\u7f6e swoole dns \u7f13\u5b58\u5bb9\u91cf\uff0c\u9ed8\u8ba4 1000 \u3002 dns_server TODO display_errors TODO aio_core_worker_num TODO aio_worker_num TODO aio_max_wait_time TODO aio_max_idle_time TODO","title":"Coroutine::set"},{"location":"coroutine/coroutine/set/#coroutineset","text":"Coroutine::set \u7528\u6765\u8bbe\u7f6e\u534f\u7a0b\u76f8\u5173\u9009\u9879\u3002","title":"Coroutine::set"},{"location":"coroutine/coroutine/set/#_1","text":"Swoole\\Coroutine::set <?php public static function set ( $options ) { } @ param array $options @ return mixed","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/set/#_2","text":"","title":"\u53c2\u6570"},{"location":"coroutine/coroutine/set/#array-options","text":"\u76f8\u5173\u7684\u914d\u7f6e\u9879\u3002","title":"array $options"},{"location":"coroutine/coroutine/set/#max_coroutine","text":"\u8bbe\u7f6e\u6700\u5927\u534f\u7a0b\u6570\uff0c\u8d85\u8fc7\u9650\u5236\u540e\u5e95\u5c42\u5c06\u65e0\u6cd5\u521b\u5efa\u65b0\u7684\u534f\u7a0b\u3002 \u6ce8\u610f\uff0c\u8fd9\u4e2a\u6700\u5927\u534f\u7a0b\u6570\u6307\u7684\u662f\u8fd9\u4e2a\u7ebf\u7a0b\u76ee\u524d\u5b58\u6d3b\u7684\u534f\u7a0b\u6570\uff0c\u800c\u4e0d\u662f\u521b\u5efa\u7684\u534f\u7a0b\u4e2a\u6570\u3002\u56e0\u4e3a\u6b7b\u4ea1\u7684\u534f\u7a0b\u662f\u4e0d\u8bb0\u5f55\u5728\u534f\u7a0b\u4e2a\u6570\u91cc\u9762\u7684\u3002 \u4f8b\u5b50\uff1a <?php Swoole\\Coroutine :: set ([ 'max_coroutine' => 5 , ]); for ( $i = 0 ; $i < 6 ; $i ++ ) { go ( function () { echo 'swoole' . PHP_EOL ; }); } swoole swoole swoole swoole swoole swoole \u4f9d\u7136\u53ef\u4ee5\u521b\u5efa\u51fa 6 \u4e2a\u534f\u7a0b\u3002\u56e0\u4e3a\u534f\u7a0b\u521b\u5efa\u5b8c\u4e4b\u540e\uff0c\u6267\u884c echo \u5c31\u4f1a\u7acb\u9a6c\u6b7b\u4ea1\uff0c\u63a5\u7740\u521b\u5efa\u4e0b\u4e00\u4e2a\u534f\u7a0b\u3002 \u4f46\u662f\uff0c\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u662f\u4f1a\u5931\u8d25\u7684\uff1a <?php Swoole\\Coroutine :: set ([ 'max_coroutine' => 5 , ]); go ( function () { echo 'swoole' . PHP_EOL ; go ( function () { echo 'swoole' . PHP_EOL ; go ( function () { echo 'swoole' . PHP_EOL ; go ( function () { echo 'swoole' . PHP_EOL ; go ( function () { echo 'swoole' . PHP_EOL ; go ( function () { echo 'swoole' . PHP_EOL ; }); }); }); }); }); }); php set.php swoole swoole swoole swoole swoole PHP Warning: go () : exceed max number of coroutine 5 in /root/codeDir/phpCode/swoole/coroutine/coroutine/set.php on line 19","title":"max_coroutine"},{"location":"coroutine/coroutine/set/#hook_flags","text":"\u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u5c06\u57fa\u4e8e php_stream \u5b9e\u73b0\u7684\u6269\u5c55\u3001 PHP \u7f51\u7edc\u5ba2\u6237\u7aef\u4ee3\u7801\u4e00\u952e\u534f\u7a0b\u5316\u3002 Swoole \u521b\u5efa\u534f\u7a0b\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u662f\u4e0d\u4f1a hook \u7684\u3002 \u53ef\u4ee5 hook \u7684 flag \u6709\uff1a","title":"hook_flags"},{"location":"coroutine/coroutine/set/#swoole_hook_tcp","text":"\u4f8b\u5b50\uff1a hook \u7684 tcp \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_TCP , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $ctx = stream_context_create ([ 'socket' => [ 'so_reuseaddr' => true , 'backlog' => 128 ]]); $socket = stream_socket_server ( 'tcp://0.0.0.0:6666' , $errno , $errstr , STREAM_SERVER_BIND | STREAM_SERVER_LISTEN , $ctx ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_accept ( $socket )) { } }); echo \"here\" . PHP_EOL ; }); here \u6ca1\u6709 hook \u7684 tcp \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $ctx = stream_context_create ([ 'socket' => [ 'so_reuseaddr' => true , 'backlog' => 128 ]]); $socket = stream_socket_server ( 'tcp://0.0.0.0:6666' , $errno , $errstr , STREAM_SERVER_BIND | STREAM_SERVER_LISTEN , $ctx ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_accept ( $socket )) { } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\u3002","title":"SWOOLE_HOOK_TCP"},{"location":"coroutine/coroutine/set/#swoole_hook_udp","text":"hook \u7684 udp \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_UDP , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $socket = stream_socket_server ( 'udp://0.0.0.0:6666' , $errno , $errstr , STREAM_SERVER_BIND ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_recvfrom ( $socket , 1 , 0 )) { } }); echo \"here\" . PHP_EOL ; }); here \u6ca1\u6709 hook \u7684 udp \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $socket = stream_socket_server ( 'udp://0.0.0.0:6666' , $errno , $errstr , STREAM_SERVER_BIND ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_recvfrom ( $socket , 1 , 0 )) { } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\u3002","title":"SWOOLE_HOOK_UDP"},{"location":"coroutine/coroutine/set/#swoole_hook_unix","text":"hook \u7684 unix \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_UNIX , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $socket = stream_socket_server ( 'unix://swoole.sock' , $errno , $errstr , STREAM_SERVER_BIND | STREAM_SERVER_LISTEN ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_accept ( $socket )) { } }); echo \"here\" . PHP_EOL ; }); here \u6ca1\u6709 hook \u7684 unix \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $socket = stream_socket_server ( 'unix://swoole.sock' , $errno , $errstr , STREAM_SERVER_BIND | STREAM_SERVER_LISTEN ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_accept ( $socket )) { } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\u3002","title":"SWOOLE_HOOK_UNIX"},{"location":"coroutine/coroutine/set/#swoole_hook_udg","text":"hook \u7684 udg \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_UDG , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $socket = stream_socket_server ( 'udg://swoole.sock' , $errno , $errstr , STREAM_SERVER_BIND ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_recvfrom ( $socket , 1 , 0 )) { } }); echo \"here\" . PHP_EOL ; }); here \u6ca1\u6709 hook \u7684 udg \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $socket = stream_socket_server ( 'udg://swoole.sock' , $errno , $errstr , STREAM_SERVER_BIND ); if ( ! $socket ) { echo \" $errstr ( $errno )\" . PHP_EOL ; exit ( 1 ); } while ( stream_socket_recvfrom ( $socket , 1 , 0 )) { } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\u3002","title":"SWOOLE_HOOK_UDG"},{"location":"coroutine/coroutine/set/#swoole_hook_ssl","text":"TODO","title":"SWOOLE_HOOK_SSL"},{"location":"coroutine/coroutine/set/#swoole_hook_tls","text":"TODO","title":"SWOOLE_HOOK_TLS"},{"location":"coroutine/coroutine/set/#swoole_hook_stream_function","text":"TODO","title":"SWOOLE_HOOK_STREAM_FUNCTION"},{"location":"coroutine/coroutine/set/#swoole_hook_file","text":"hook \u7684 file \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_FILE , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $fp = fopen ( __FILE__ , 'r' ); while ( true ) { fread ( $fp , 1024 ); } }); echo \"here\" . PHP_EOL ; }); here \u6ca1\u6709 hook \u7684 file \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $fp = fopen ( __FILE__ , 'r' ); while ( true ) { fread ( $fp , 1024 ); } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\u3002","title":"SWOOLE_HOOK_FILE"},{"location":"coroutine/coroutine/set/#swoole_hook_sleep","text":"\u4f8b\u5b50\uff1a hook \u7684 sleep \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_SLEEP , ]); Swoole\\Coroutine\\run ( function () { go ( function () { sleep ( 1 ); echo '1' . PHP_EOL ; }); go ( function () { echo '2' . PHP_EOL ; }); }); 2 1 \u6ca1\u6709 hook \u7684 sleep \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { sleep ( 1 ); echo '1' . PHP_EOL ; }); go ( function () { echo '2' . PHP_EOL ; }); }); 1 2","title":"SWOOLE_HOOK_SLEEP"},{"location":"coroutine/coroutine/set/#swoole_hook_proc","text":"hook \u7684 proc \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_PROC , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $descriptorspec = array ( 0 => array ( \"pipe\" , \"r\" ), // stdin, child process read from it 1 => array ( \"pipe\" , \"w\" ), // stdout, child process write to it ); $process = proc_open ( 'php' , $descriptorspec , $pipes ); if ( is_resource ( $process )) { fwrite ( $pipes [ 0 ], '<?php echo \"I am process\\n\" ?>' ); fclose ( $pipes [ 0 ]); while ( true ) { echo fread ( $pipes [ 1 ], 1024 ); } fclose ( $pipes [ 1 ]); $return_value = proc_close ( $process ); echo \"command returned $return_value \" . PHP_EOL ; } }); echo \"here\" . PHP_EOL ; }); \u6253\u5370\u51fa here \u5b57\u7b26\u4e32\uff1a here I am process \u6ca1\u6709 hook \u7684 proc \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $descriptorspec = array ( 0 => array ( \"pipe\" , \"r\" ), // stdin, child process read from it 1 => array ( \"pipe\" , \"w\" ), // stdout, child process write to it ); $process = proc_open ( 'php' , $descriptorspec , $pipes ); if ( is_resource ( $process )) { fwrite ( $pipes [ 0 ], '<?php echo \"I am process\\n\" ?>' ); fclose ( $pipes [ 0 ]); while ( true ) { echo fread ( $pipes [ 1 ], 1024 ); } fclose ( $pipes [ 1 ]); $return_value = proc_close ( $process ); echo \"command returned $return_value \" . PHP_EOL ; } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\uff1a I am process","title":"SWOOLE_HOOK_PROC"},{"location":"coroutine/coroutine/set/#swoole_hook_blocking_function","text":"\u8fd9\u91cc\u7684 blocking function \u5305\u62ec\u4e86\uff1a gethostbyname \u3001 exec \u3001 shell_exec \u3002 hook \u7684 blocking function \uff1a <?php Swoole\\Coroutine :: set ([ 'hook_flags' => SWOOLE_HOOK_BLOCKING_FUNCTION , ]); Swoole\\Coroutine\\run ( function () { go ( function () { while ( true ) { exec ( \"cat\" ); } }); echo \"here\" . PHP_EOL ; }); here \u6ca1\u6709 hook \u7684 blocking function \uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { while ( true ) { exec ( \"cat\" ); } }); echo \"here\" . PHP_EOL ; }); \u6b64\u65f6\u4e0d\u4f1a\u6253\u5370\u51fa here \u5b57\u7b26\u4e32\u3002","title":"SWOOLE_HOOK_BLOCKING_FUNCTION"},{"location":"coroutine/coroutine/set/#swoole_hook_curl","text":"TODO","title":"SWOOLE_HOOK_CURL"},{"location":"coroutine/coroutine/set/#c_stack_size","text":"\u8bbe\u7f6e\u5355\u4e2a\u534f\u7a0b\u521d\u59cb\u6808\u7684\u5185\u5b58\u5c3a\u5bf8\uff0c\u5355\u4f4d\u662f B \uff0c\u9ed8\u8ba4\u4e3a 2 * 1024 * 1024B \uff0c\u5373 2MB \u3002\u8303\u56f4\uff1a 256 * 1024B \uff5e 16 * 1024 * 1024 \u3002 \u6ce8\u610f\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u7684\u662f\u534f\u7a0b\u521d\u59cbC\u6808\u7684\u5927\u5c0f\uff0c\u800c\u4e0d\u662f\u534f\u7a0b\u521d\u59cbPHP\u6808\u7684\u5927\u5c0f\u3002 \u534f\u7a0b\u521d\u59cbPHP\u6808\u7684\u5927\u5c0f\u76ee\u524d\u662f\u56fa\u5b9a\u76848 * 1024B\u3002","title":"c_stack_size"},{"location":"coroutine/coroutine/set/#socket_connect_timeout","text":"\u5efa\u7acb socket \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4, \u5355\u4f4d\uff1a s \uff0c\u9ed8\u8ba4\u4e3a 1s \u3002\u8bbe\u7f6e\u4e3a -1 \uff0c\u8868\u793a\u6c38\u4e0d\u8d85\u65f6\u3002 \u6ce8\u610f\uff0c\u8fd9\u91cc\u4e0d\u80fd\u8bbe\u7f6e\u4e3a0\u3002\u8bbe\u7f6e\u4e3a0\u7684\u8bdd\uff0c\u4f1a\u53d6\u9ed8\u8ba4\u503c\u3002","title":"socket_connect_timeout"},{"location":"coroutine/coroutine/set/#socket_timeout","text":"\u8bbe\u7f6e socket \u8bfb\u548c\u5199\u7684\u64cd\u4f5c\u8d85\u65f6\u65f6\u95f4, \u5355\u4f4d\uff1a s \uff0c\u9ed8\u8ba4\u4e3a -1 , \u5373\u6c38\u4e0d\u8d85\u65f6\u3002 \u6ce8\u610f\uff0c\u8fd9\u91cc\u4e0d\u80fd\u8bbe\u7f6e\u4e3a0\u3002\u8bbe\u7f6e\u4e3a0\u7684\u8bdd\uff0c\u4f1a\u53d6\u9ed8\u8ba4\u503c\u3002","title":"socket_timeout"},{"location":"coroutine/coroutine/set/#socket_read_timeout","text":"\u53ea\u8bbe\u7f6e socket \u8bfb\u7684\u64cd\u4f5c\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d s \uff0c\u9ed8\u8ba4\u4e3a -1 , \u5373\u6c38\u4e0d\u8d85\u65f6\u3002 \u6ce8\u610f\uff0c\u8fd9\u91cc\u4e0d\u80fd\u8bbe\u7f6e\u4e3a0\u3002\u8bbe\u7f6e\u4e3a0\u7684\u8bdd\uff0c\u4f1a\u53d6\u9ed8\u8ba4\u503c\u3002","title":"socket_read_timeout"},{"location":"coroutine/coroutine/set/#socket_write_timeout","text":"\u53ea\u8bbe\u7f6e socket \u5199\u7684\u64cd\u4f5c\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d s \uff0c\u9ed8\u8ba4\u4e3a -1 , \u5373\u6c38\u4e0d\u8d85\u65f6\u3002 \u6ce8\u610f\uff0c\u8fd9\u91cc\u4e0d\u80fd\u8bbe\u7f6e\u4e3a0\u3002\u8bbe\u7f6e\u4e3a0\u7684\u8bdd\uff0c\u4f1a\u53d6\u9ed8\u8ba4\u503c\u3002","title":"socket_write_timeout"},{"location":"coroutine/coroutine/set/#log_level","text":"\u8bbe\u7f6e\u65e5\u5fd7\u7b49\u7ea7\u3002\u5927\u4e8e\u7b49\u4e8e\u8fd9\u4e2a\u65e5\u5fd7\u7b49\u7ea7\u7684\u65e5\u5fd7 \u624d \u4f1a\u88ab\u6253\u5370\u51fa\u6765\u3002 \u6ce8\u610f\uff0c\u8fd9\u91cc\u914d\u7f6e\u7684\u4e0d\u662fPHP\u5c42\u7684\u65e5\u5fd7\u7ea7\u522b\uff0c\u800c\u662fC\u5c42\u7684\u65e5\u5fd7\u7ea7\u522b\uff0c\u540e\u9762\u4f1a\u6709\u4e00\u4e2a\u4f8b\u5b50\u8fdb\u884c\u8bf4\u660e\u3002 \u53ef\u914d\u7f6e\u7684\u65e5\u5fd7\u7b49\u7ea7\u4ece\u4f4e\u5230\u9ad8\u4e3a\uff1a SWOOLE_LOG_DEBUG SWOOLE_LOG_TRACE SWOOLE_LOG_INFO SWOOLE_LOG_NOTICE SWOOLE_LOG_WARNING SWOOLE_LOG_ERROR \u6ce8\u610f\uff0c\u5982\u679c\u5728\u7f16\u8bd1 Swoole \u7684\u65f6\u5019\u5f00\u542f\u4e86 debug \uff0c\u90a3\u4e48 log_level \u9ed8\u8ba4\u662f SWOOLE_LOG_DEBUG \uff1b\u5426\u5219 log_level \u9ed8\u8ba4\u662f SWOOLE_LOG_INFO \u3002 \u6ca1\u6709\u8bbe\u7f6e log_level \u7684\u4f8b\u5b50\uff1a <?php Swoole\\Coroutine\\run ( function () { go ( function () { $client = new Swoole\\Coroutine\\Client ( SWOOLE_TCP ); $client -> connect ( '127.0.0.1' ); }); }); \u6b64\u65f6\u4f1a\u6253\u5370 PHP \u5c42 Warning \u7ea7\u522b\u7684\u8b66\u544a\uff1a PHP Warning: Swoole \\C oroutine \\C lient::connect () : The port is invalid in /root/codeDir/phpCode/swoole/coroutine/coroutine/set.php on line 6 \u8bbe\u7f6e log_level \u7684\u4f8b\u5b50\uff1a <?php Swoole\\Coroutine :: set ([ 'log_level' => SWOOLE_LOG_ERROR , ]); Swoole\\Coroutine\\run ( function () { go ( function () { $client = new Swoole\\Coroutine\\Client ( SWOOLE_TCP ); $client -> connect ( '127.0.0.1' ); }); }); \u6b64\u65f6\u4f9d\u7136\u4f1a\u6253\u5370\u51fa PHP \u5c42 Warning \u7ea7\u522b\u7684\u8b66\u544a\uff1a PHP Warning: Swoole \\C oroutine \\C lient::connect () : The port is invalid in /root/codeDir/phpCode/swoole/coroutine/coroutine/set.php on line 10","title":"log_level"},{"location":"coroutine/coroutine/set/#trace_flags","text":"TODO","title":"trace_flags"},{"location":"coroutine/coroutine/set/#dns_cache_expire","text":"\u8bbe\u7f6e swoole dns \u7f13\u5b58\u5931\u6548\u65f6\u95f4\uff0c\u5355\u4f4d s \uff0c\u9ed8\u8ba4 60s \u3002","title":"dns_cache_expire"},{"location":"coroutine/coroutine/set/#dns_cache_capacity","text":"\u8bbe\u7f6e swoole dns \u7f13\u5b58\u5bb9\u91cf\uff0c\u9ed8\u8ba4 1000 \u3002","title":"dns_cache_capacity"},{"location":"coroutine/coroutine/set/#dns_server","text":"TODO","title":"dns_server"},{"location":"coroutine/coroutine/set/#display_errors","text":"TODO","title":"display_errors"},{"location":"coroutine/coroutine/set/#aio_core_worker_num","text":"TODO","title":"aio_core_worker_num"},{"location":"coroutine/coroutine/set/#aio_worker_num","text":"TODO","title":"aio_worker_num"},{"location":"coroutine/coroutine/set/#aio_max_wait_time","text":"TODO","title":"aio_max_wait_time"},{"location":"coroutine/coroutine/set/#aio_max_idle_time","text":"TODO","title":"aio_max_idle_time"},{"location":"coroutine/coroutine/stats/","text":"Coroutine::stats \u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684\u72b6\u6001\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::stats <?php public static function stats () { } @ return array \u65e0\u53c2\u6570 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { var_dump ( Coroutine :: stats ()); }); array ( 8 ) { [ \"event_num\" ]= > int ( 0 ) [ \"signal_listener_num\" ]= > int ( 0 ) [ \"aio_task_num\" ]= > int ( 0 ) [ \"aio_worker_num\" ]= > int ( 0 ) [ \"c_stack_size\" ]= > int ( 2097152 ) [ \"coroutine_num\" ]= > int ( 1 ) [ \"coroutine_peak_num\" ]= > int ( 1 ) [ \"coroutine_last_cid\" ]= > int ( 1 ) } \u8fd4\u56de\u503c array \u7c7b\u578b\u3002 event_num \u5f53\u524d\u8fdb\u7a0b\u6240\u6ce8\u518c\u7684\u4e8b\u4ef6\u4e2a\u6570\u3002\u4f8b\u5982\uff0c\u5728\u7f51\u7edc\u670d\u52a1\u5668\u4e2d\uff0c accept \u4f1a\u4ea7\u751f\u4e00\u4e2a event \u3002\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use Swoole\\Coroutine\\Socket ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { $socket = new Socket ( AF_INET , SWOOLE_TCP ); $socket -> bind ( \"127.0.0.1\" , 9501 ); $socket -> listen (); while ( true ) { $conn = $socket -> accept (); } }); var_dump ( Coroutine :: stats ()[ 'event_num' ]); }); int ( 1 ) signal_listener_num TODO aio_task_num TODO aio_worker_num TODO c_stack_size \u6ce8\u610f\uff0c\u8fd9\u91cc\u4e0d\u662f\u6307\u6240\u6709\u534f\u7a0b\u52a0\u8d77\u6765\u7684C\u6808\u5927\u5c0f\uff0c\u800c\u662f\u5f53\u524d\u914d\u7f6e\u597d\u7684\u6bcf\u4e2a\u534f\u7a0b\u521d\u59cb C \u6808\u5927\u5c0f \u53ef\u4ee5\u5728\u521b\u5efa\u534f\u7a0b\u4e4b\u524d\uff0c\u914d\u7f6e\u597d\u534f\u7a0b C \u6808\u7684\u5927\u5c0f\u3002\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use Swoole\\Coroutine\\Socket ; use function Swoole\\Coroutine\\run ; Coroutine :: set ([ 'c_stack_size' => 3 * 1024 * 1024 , ]); run ( function () { go ( function () { var_dump ( Coroutine :: stats ()[ 'c_stack_size' ]); }); }); int ( 3145728 ) coroutine_num \u5f53\u524d\u8fdb\u7a0b\u4e2d\u5b58\u6d3b\u7684\u534f\u7a0b\u4e2a\u6570\uff0c\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use Swoole\\Coroutine\\Socket ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { }); var_dump ( Coroutine :: stats ()[ 'coroutine_num' ]); }); int ( 1 ) \u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e24\u4e2a\u534f\u7a0b\uff08 run \u51fd\u6570\u4f1a\u521b\u5efa\u4e00\u4e2a\u534f\u7a0b\uff09\uff0c\u4f46\u662f coroutine_num \u662f 1 \u3002 coroutine_peak_num \u5f53\u524d\u8fdb\u7a0b\u4e2d \u5b58\u6d3b \u7684\u534f\u7a0b\u6700\u5927\u4e2a\u6570\u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use Swoole\\Coroutine\\Socket ; use function Swoole\\Coroutine\\run ; run ( function () { for ( $i = 0 ; $i < 5 ; $i ++ ) { go ( function () { }); } var_dump ( Coroutine :: stats ()[ 'coroutine_peak_num' ]); }); int ( 2 ) \u5c3d\u7ba1\u5728 run \u51fd\u6570\u91cc\u9762\u521b\u5efa\u4e86 5 \u4e2a\u534f\u7a0b\uff0c\u4f46\u662f\u534f\u7a0b\u6bcf\u6b21\u521b\u5efa\u5b8c\u4e4b\u540e\u5c31\u7acb\u9a6c\u6b7b\u4ea1\uff0c\u6240\u4ee5\u5cf0\u503c\u662f 2 \u4e2a\u3002 coroutine_last_cid \u5f53\u524d\u8fdb\u7a0b\u7684\u6700\u540e\u4e00\u4e2a\u534f\u7a0b cid \u3002","title":"Coroutine::stats"},{"location":"coroutine/coroutine/stats/#coroutinestats","text":"\u83b7\u53d6\u5f53\u524d\u534f\u7a0b\u7684\u72b6\u6001\u3002","title":"Coroutine::stats"},{"location":"coroutine/coroutine/stats/#_1","text":"Swoole\\Coroutine::stats <?php public static function stats () { } @ return array","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/stats/#_2","text":"\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { var_dump ( Coroutine :: stats ()); }); array ( 8 ) { [ \"event_num\" ]= > int ( 0 ) [ \"signal_listener_num\" ]= > int ( 0 ) [ \"aio_task_num\" ]= > int ( 0 ) [ \"aio_worker_num\" ]= > int ( 0 ) [ \"c_stack_size\" ]= > int ( 2097152 ) [ \"coroutine_num\" ]= > int ( 1 ) [ \"coroutine_peak_num\" ]= > int ( 1 ) [ \"coroutine_last_cid\" ]= > int ( 1 ) }","title":"\u65e0\u53c2\u6570"},{"location":"coroutine/coroutine/stats/#_3","text":"array \u7c7b\u578b\u3002","title":"\u8fd4\u56de\u503c"},{"location":"coroutine/coroutine/stats/#event_num","text":"\u5f53\u524d\u8fdb\u7a0b\u6240\u6ce8\u518c\u7684\u4e8b\u4ef6\u4e2a\u6570\u3002\u4f8b\u5982\uff0c\u5728\u7f51\u7edc\u670d\u52a1\u5668\u4e2d\uff0c accept \u4f1a\u4ea7\u751f\u4e00\u4e2a event \u3002\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use Swoole\\Coroutine\\Socket ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { $socket = new Socket ( AF_INET , SWOOLE_TCP ); $socket -> bind ( \"127.0.0.1\" , 9501 ); $socket -> listen (); while ( true ) { $conn = $socket -> accept (); } }); var_dump ( Coroutine :: stats ()[ 'event_num' ]); }); int ( 1 )","title":"event_num"},{"location":"coroutine/coroutine/stats/#signal_listener_num","text":"TODO","title":"signal_listener_num"},{"location":"coroutine/coroutine/stats/#aio_task_num","text":"TODO","title":"aio_task_num"},{"location":"coroutine/coroutine/stats/#aio_worker_num","text":"TODO","title":"aio_worker_num"},{"location":"coroutine/coroutine/stats/#c_stack_size","text":"\u6ce8\u610f\uff0c\u8fd9\u91cc\u4e0d\u662f\u6307\u6240\u6709\u534f\u7a0b\u52a0\u8d77\u6765\u7684C\u6808\u5927\u5c0f\uff0c\u800c\u662f\u5f53\u524d\u914d\u7f6e\u597d\u7684\u6bcf\u4e2a\u534f\u7a0b\u521d\u59cb C \u6808\u5927\u5c0f \u53ef\u4ee5\u5728\u521b\u5efa\u534f\u7a0b\u4e4b\u524d\uff0c\u914d\u7f6e\u597d\u534f\u7a0b C \u6808\u7684\u5927\u5c0f\u3002\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use Swoole\\Coroutine\\Socket ; use function Swoole\\Coroutine\\run ; Coroutine :: set ([ 'c_stack_size' => 3 * 1024 * 1024 , ]); run ( function () { go ( function () { var_dump ( Coroutine :: stats ()[ 'c_stack_size' ]); }); }); int ( 3145728 )","title":"c_stack_size"},{"location":"coroutine/coroutine/stats/#coroutine_num","text":"\u5f53\u524d\u8fdb\u7a0b\u4e2d\u5b58\u6d3b\u7684\u534f\u7a0b\u4e2a\u6570\uff0c\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use Swoole\\Coroutine\\Socket ; use function Swoole\\Coroutine\\run ; run ( function () { go ( function () { }); var_dump ( Coroutine :: stats ()[ 'coroutine_num' ]); }); int ( 1 ) \u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e24\u4e2a\u534f\u7a0b\uff08 run \u51fd\u6570\u4f1a\u521b\u5efa\u4e00\u4e2a\u534f\u7a0b\uff09\uff0c\u4f46\u662f coroutine_num \u662f 1 \u3002","title":"coroutine_num"},{"location":"coroutine/coroutine/stats/#coroutine_peak_num","text":"\u5f53\u524d\u8fdb\u7a0b\u4e2d \u5b58\u6d3b \u7684\u534f\u7a0b\u6700\u5927\u4e2a\u6570\u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use Swoole\\Coroutine\\Socket ; use function Swoole\\Coroutine\\run ; run ( function () { for ( $i = 0 ; $i < 5 ; $i ++ ) { go ( function () { }); } var_dump ( Coroutine :: stats ()[ 'coroutine_peak_num' ]); }); int ( 2 ) \u5c3d\u7ba1\u5728 run \u51fd\u6570\u91cc\u9762\u521b\u5efa\u4e86 5 \u4e2a\u534f\u7a0b\uff0c\u4f46\u662f\u534f\u7a0b\u6bcf\u6b21\u521b\u5efa\u5b8c\u4e4b\u540e\u5c31\u7acb\u9a6c\u6b7b\u4ea1\uff0c\u6240\u4ee5\u5cf0\u503c\u662f 2 \u4e2a\u3002","title":"coroutine_peak_num"},{"location":"coroutine/coroutine/stats/#coroutine_last_cid","text":"\u5f53\u524d\u8fdb\u7a0b\u7684\u6700\u540e\u4e00\u4e2a\u534f\u7a0b cid \u3002","title":"coroutine_last_cid"},{"location":"coroutine/coroutine/yield/","text":"Coroutine::yield \u8ba9\u51fa\u5f53\u524d\u534f\u7a0b\u7684\u6267\u884c\u6743\u3002 \u65b9\u6cd5\u539f\u578b Swoole\\Coroutine::yield <?php public static function yield () { } @ return mixed \u65e0\u53c2\u6570 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { $cid = go ( function () { var_dump ( Coroutine :: getCid ()); Coroutine :: yield (); var_dump ( Coroutine :: getCid ()); }); go ( function () use ( $cid ) { var_dump ( Coroutine :: getCid ()); Coroutine :: resume ( $cid ); var_dump ( Coroutine :: getCid ()); }); }); int ( 2 ) int ( 3 ) int ( 2 ) int ( 3 ) \u6ce8\u610f \u5fc5\u987b\u4e0e Coroutine::resume() \u65b9\u6cd5\u6210\u5bf9\u4f7f\u7528\u3002\u8be5\u534f\u7a0b yield \u4ee5\u540e\uff0c\u5fc5\u987b\u7531\u5176\u4ed6\u5916\u90e8\u534f\u7a0b resume \uff0c\u5426\u5219\u5c06\u4f1a\u9020\u6210\u534f\u7a0b\u6cc4\u6f0f\uff0c\u88ab\u6302\u8d77\u7684\u534f\u7a0b\u6c38\u8fdc\u4e0d\u4f1a\u6267\u884c\uff0c\u4ece\u800c\u9020\u6210\u5185\u5b58\u6cc4\u9732\u3002\u6240\u4ee5 \u4e0d\u63a8\u8350 \u5f00\u53d1\u8005\u4f7f\u7528\u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { $cid = go ( function () { var_dump ( Coroutine :: getCid ()); Coroutine :: yield (); var_dump ( Coroutine :: getCid ()); }); go ( function () use ( $cid ) { var_dump ( Coroutine :: getCid ()); }); }); int ( 2 ) int ( 3 ) \u6b64\u65f6\uff0c cid \u4e3a 2 \u7684\u534f\u7a0b\u4e0d\u4f1a\u91cd\u65b0\u6267\u884c\u3002","title":"Coroutine::yield"},{"location":"coroutine/coroutine/yield/#coroutineyield","text":"\u8ba9\u51fa\u5f53\u524d\u534f\u7a0b\u7684\u6267\u884c\u6743\u3002","title":"Coroutine::yield"},{"location":"coroutine/coroutine/yield/#_1","text":"Swoole\\Coroutine::yield <?php public static function yield () { } @ return mixed","title":"\u65b9\u6cd5\u539f\u578b"},{"location":"coroutine/coroutine/yield/#_2","text":"\u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { $cid = go ( function () { var_dump ( Coroutine :: getCid ()); Coroutine :: yield (); var_dump ( Coroutine :: getCid ()); }); go ( function () use ( $cid ) { var_dump ( Coroutine :: getCid ()); Coroutine :: resume ( $cid ); var_dump ( Coroutine :: getCid ()); }); }); int ( 2 ) int ( 3 ) int ( 2 ) int ( 3 )","title":"\u65e0\u53c2\u6570"},{"location":"coroutine/coroutine/yield/#_3","text":"\u5fc5\u987b\u4e0e Coroutine::resume() \u65b9\u6cd5\u6210\u5bf9\u4f7f\u7528\u3002\u8be5\u534f\u7a0b yield \u4ee5\u540e\uff0c\u5fc5\u987b\u7531\u5176\u4ed6\u5916\u90e8\u534f\u7a0b resume \uff0c\u5426\u5219\u5c06\u4f1a\u9020\u6210\u534f\u7a0b\u6cc4\u6f0f\uff0c\u88ab\u6302\u8d77\u7684\u534f\u7a0b\u6c38\u8fdc\u4e0d\u4f1a\u6267\u884c\uff0c\u4ece\u800c\u9020\u6210\u5185\u5b58\u6cc4\u9732\u3002\u6240\u4ee5 \u4e0d\u63a8\u8350 \u5f00\u53d1\u8005\u4f7f\u7528\u3002 \u4f8b\u5b50\uff1a <?php use Swoole\\Coroutine ; use function Swoole\\Coroutine\\run ; run ( function () { $cid = go ( function () { var_dump ( Coroutine :: getCid ()); Coroutine :: yield (); var_dump ( Coroutine :: getCid ()); }); go ( function () use ( $cid ) { var_dump ( Coroutine :: getCid ()); }); }); int ( 2 ) int ( 3 ) \u6b64\u65f6\uff0c cid \u4e3a 2 \u7684\u534f\u7a0b\u4e0d\u4f1a\u91cd\u65b0\u6267\u884c\u3002","title":"\u6ce8\u610f"}]}